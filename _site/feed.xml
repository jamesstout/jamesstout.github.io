<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.0">Jekyll</generator><link href="https://stouty.xyz/feed.xml" rel="self" type="application/atom+xml" /><link href="https://stouty.xyz/" rel="alternate" type="text/html" /><updated>2018-09-20T04:05:17+08:00</updated><id>https://stouty.xyz/</id><title type="html">stouty.xyz</title><subtitle>James Stout. CTO. iOS. Web developer. Flatliner. Tech, crypto, comedy, Hong Kong, #hcafc, smashing telly and, of course, the weather.</subtitle><author><name>James Stout</name></author><entry><title type="html">asciinema</title><link href="https://stouty.xyz/macos/2018/09/20/asciinema/" rel="alternate" type="text/html" title="asciinema" /><published>2018-09-20T01:56:01+08:00</published><updated>2018-09-20T01:56:01+08:00</updated><id>https://stouty.xyz/macos/2018/09/20/asciinema</id><content type="html" xml:base="https://stouty.xyz/macos/2018/09/20/asciinema/">&lt;p&gt;I’ve been playing around with &lt;a href=&quot;https://asciinema.org/&quot;&gt;asciinema&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Record and share your terminal sessions, the right way.&lt;/p&gt;

  &lt;p&gt;Forget screen recording apps and blurry video. Enjoy a lightweight, purely text-based approach to terminal recording.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It’s simple to &lt;a href=&quot;https://asciinema.org/docs/installation&quot;&gt;install&lt;/a&gt;&lt;sup id=&quot;fnref:fn-req&quot;&gt;&lt;a href=&quot;#fn:fn-req&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; and &lt;a href=&quot;https://asciinema.org/docs/usage&quot;&gt;use&lt;/a&gt; and has a few &lt;a href=&quot;https://asciinema.org/docs/embedding&quot;&gt;sharing and embedding&lt;/a&gt; options.&lt;/p&gt;

&lt;p&gt;Here’s me starting up a &lt;a href=&quot;https://www.vagrantup.com/&quot;&gt;Vagrant&lt;/a&gt; box:&lt;/p&gt;

&lt;script src=&quot;https://asciinema.org/a/MEjWz4OBlLHalz4xuyTHkCaSH.js&quot; id=&quot;asciicast-MEjWz4OBlLHalz4xuyTHkCaSH&quot; async=&quot;&quot; data-preload=&quot;false&quot;&gt;&lt;/script&gt;

&lt;p&gt;A nice feature is being able to record some casts, before creating an account, then later, if you create an account, your recordings&lt;sup id=&quot;fnref:fn-id&quot;&gt;&lt;a href=&quot;#fn:fn-id&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; associated with your account:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Install ID is a random ID (UUID v4) generated locally when you run asciinema for the first time, and saved at $HOME/.config/asciinema/install-id. It’s purpose is to connect local machine with uploaded recordings, so they can later be associated with asciinema.org 15 account. This way we decouple uploading from account creation, allowing them to happen in any order.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;asciinema-player src=&quot;/assets/images/posts/asciinema/202045.cast&quot; cols=&quot;116&quot; rows=&quot;28&quot;&gt;&lt;/asciinema-player&gt;

&lt;hr /&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-req&quot;&gt;
      &lt;p&gt;Requires &lt;a href=&quot;https://www.python.org/&quot;&gt;Python 3&lt;/a&gt;, or you could use a &lt;a href=&quot;https://asciinema.org/docs/installation#running-in-docker-container&quot;&gt;Docker container&lt;/a&gt;. &lt;a href=&quot;#fnref:fn-req&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:fn-id&quot;&gt;
      &lt;p&gt;From that specific machine. &lt;a href=&quot;#fnref:fn-id&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="terminal" /><category term="macOS" /><category term="bash" /><summary type="html">asciinema. Record and share your terminal sessions, the right way.</summary></entry><entry><title type="html">Reverse Engineering HKBN Speed Test for macOS</title><link href="https://stouty.xyz/macos/2018/08/18/hkbn/" rel="alternate" type="text/html" title="Reverse Engineering HKBN Speed Test for macOS" /><published>2018-08-18T17:29:01+08:00</published><updated>2018-08-18T17:29:01+08:00</updated><id>https://stouty.xyz/macos/2018/08/18/hkbn</id><content type="html" xml:base="https://stouty.xyz/macos/2018/08/18/hkbn/">&lt;p&gt;HKBN seem to no longer have a macOS app to test local broadband speeds, only &lt;a href=&quot;https://www.hkbn.net/new/en/speedtest.shtml&quot;&gt;Windows&lt;/a&gt;. They previously had an app called &lt;em&gt;HKBNLocalSpeedTest&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Sure you could just use &lt;a href=&quot;http://www.speedtest.net/&quot;&gt;speedtest.net&lt;/a&gt;, but I wondered if I could reverse engineer their old app?&lt;/p&gt;

&lt;p&gt;Alas I no longer have the app, but analysed it previously. It was basically &lt;code class=&quot;highlighter-rouge&quot;&gt;iperf&lt;/code&gt;&lt;sup id=&quot;fnref:fn-iperf&quot;&gt;&lt;a href=&quot;#fn:fn-iperf&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;upnpc&lt;/code&gt;&lt;sup id=&quot;fnref:fn-upnpc&quot;&gt;&lt;a href=&quot;#fn:fn-upnpc&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; and some AppleScripts to manipulate the output from &lt;code class=&quot;highlighter-rouge&quot;&gt;iperf&lt;/code&gt; then load the results into a URL for display.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;upnpc&lt;/code&gt; was used to route a port on your public IP address to the same port on your local IP, to make your local machine accessible from the Internet.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;iperf&lt;/code&gt; was started in client and server mode and the client pointed to iperfmac.speedtest.com.hk. Wait for a bit, parse the output and post to the URL.&lt;/p&gt;

&lt;p&gt;The shell script I devised is shown below and linked &lt;a href=&quot;/assets/files/HKBN-speedtest.sh&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;hkbn-results&quot;&gt;HKBN Results&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/hkbn/HKBN-speedtest.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;HKBN-speedtest&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;ookla-results&quot;&gt;Ookla Results&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/hkbn/ookla-speedtest.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;ookla-speedtest&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Pretty close…&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&quot;script-listing&quot;&gt;Script listing&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# shellcheck shell=bash&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ------------------------------------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# LOGGING UTILS&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ------------------------------------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# debug logging&lt;/span&gt;
info&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;tput setaf 2&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;tput sgr0&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;n&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Error logging&lt;/span&gt;
error&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;tput setaf 1&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;x %s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;tput sgr0&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;n&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;upnpc &amp;amp;&amp;gt;/dev/null&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;info  &lt;span class=&quot;s2&quot;&gt;&quot;upnpc is installed&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;error &lt;span class=&quot;s2&quot;&gt;&quot;upnpc is NOT installed, brew install miniupnpc, or build from source: https://miniupnp.tuxfamily.org/files/&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;255
&lt;span class=&quot;k&quot;&gt;fi

if &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;iperf &amp;amp;&amp;gt;/dev/null&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;info  &lt;span class=&quot;s2&quot;&gt;&quot;iperf is installed&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;error &lt;span class=&quot;s2&quot;&gt;&quot;iperf is NOT installed, brew install iperf, or build from source: https://downloads.sourceforge.net/project/iperf/iperf-2.0.5.tar.gz&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;255
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;iperfApp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; iperf&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;upnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; upnpc&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;TMP_DIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;/usr/bin/mktemp &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 2&amp;gt; /dev/null &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; /usr/bin/mktemp &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; tmp&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

info &lt;span class=&quot;s2&quot;&gt;&quot;TMP_DIR = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$TMP_DIR&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# cleanup temp dir on exit&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;trap&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'rm -rf $TMP_DIR'&lt;/span&gt; EXIT

&lt;span class=&quot;nv&quot;&gt;upnp_txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$TMP_DIR&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/upnp.txt&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;err_txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$TMP_DIR&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/error.txt&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;res_txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$TMP_DIR&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/result.txt&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;load_url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://reg.hkbn.net/DosPatch_PingTest/mac/en/loading.html&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;iper = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$iperfApp&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# shellcheck disable=SC2009&lt;/span&gt;
psg &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    ps &lt;span class=&quot;nt&quot;&gt;-aef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;auto &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;:0:1&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;:1&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;0
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

osascript &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'on run {load_url}'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tell application &quot;Safari&quot; to activate'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tell application &quot;Safari&quot; to make new document with properties{URL:load_url}'&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'end run'&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$load_url&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$upnp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 6001 tcp 2&amp;gt; /dev/null 1&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$upnp_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /usr/bin/dscacheutil &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; 
  /usr/bin/dscacheutil &lt;span class=&quot;nt&quot;&gt;-flushcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;else 
  &lt;/span&gt;lookupd &lt;span class=&quot;nt&quot;&gt;-flushcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$iperfApp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6001 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; m &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; 1M 2&amp;gt;&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$err_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; 1&amp;gt;&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &amp;amp; 

&lt;span class=&quot;nv&quot;&gt;PID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$!&lt;/span&gt;
psg iperf

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;iperf pid = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PID&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$iperfApp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; iperfmac.speedtest.com.hk &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6001 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 10 &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 35 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; m 2&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$err_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; 1&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

psg iperf
info &lt;span class=&quot;s2&quot;&gt;&quot;sleeping for 20&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;20

&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$PID&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$upnp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 6001 tcp 2&amp;gt; /dev/null 1&amp;gt;&amp;gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$upnp_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;$'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; msgArray &amp;lt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;errmsg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&amp;lt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$err_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$errmsg&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;  
&lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;error &lt;span class=&quot;s2&quot;&gt;&quot;not ok&quot;&lt;/span&gt;
osascript &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;'
tell application &quot;Safari&quot;
  do JavaScript &quot;alert('Exceed maximum number of speed test, please try again later. （1004）');&quot; in document 1
end tell
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;END
&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;255
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;info &lt;span class=&quot;s2&quot;&gt;&quot;all ok&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;listSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

  info &lt;span class=&quot;s2&quot;&gt;&quot;msgs size is &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$listSize&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

  &lt;span class=&quot;nv&quot;&gt;server_txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;dl_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;dl_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;dl_bdw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;declare&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; dl_bdw_int

  &lt;span class=&quot;nv&quot;&gt;ul_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;ul_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;ul_bdw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;declare&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; ul_bdw_int

  &lt;span class=&quot;nv&quot;&gt;status_flag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;UL&quot;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;index &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;!msgArray[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$index&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Client connecting to&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;It's there!&quot;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;server_txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $4}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi

    if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[SUM]&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;got sum It's there!&quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;in SUM status_flag now = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;then
          &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;in DL status_flag = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;dl_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;dl_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $4}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;dl_bdw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $6}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;fi

        if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;UL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;then
          &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;in UL status_flag = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ul_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ul_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $4}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ul_bdw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;msgArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[index]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $6}'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;status_flag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DL&quot;&lt;/span&gt;
          &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;in UL status_flag now = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$status_flag&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;fi
    fi

  done

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ul_bdw_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;dl_bdw_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;ul_bdw_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;ul_bdw_int&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;dl_bdw_int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;dl_bdw_int&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

info &lt;span class=&quot;s2&quot;&gt;&quot;server = &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$server_txt&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

info &lt;span class=&quot;s2&quot;&gt;&quot;DL: interval=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; transfer=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_trn&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; bandwidth=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; bandwidth_int=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_bdw_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
info &lt;span class=&quot;s2&quot;&gt;&quot;UL: interval=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; transfer=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_trn&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; bandwidth=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; bandwidth_int=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_bdw_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;fi  

&lt;/span&gt;osascript &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;'
tell application &quot;Safari&quot;
  do JavaScript &quot;window.close();&quot; in document 1
end tell
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;END

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;res_url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://reg.hkbn.net/DosPatch_PingTest/mac/en/mac.jsp?DOWNsize=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_trn&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;DOWNduration=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;DOWNspeed=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dl_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;UPsize=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_trn&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;UPduration=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_int&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;amp;UPspeed=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ul_bdw&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

osascript &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'on run {res_url}'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tell application &quot;Safari&quot; to activate'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tell application &quot;Safari&quot; to make new document with properties{URL:res_url}'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tell application &quot;Safari&quot; to set the URL of document 1 to res_url'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'end run'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$res_url&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One caveat is that the HKBN &lt;a href=&quot;http://reg.hkbn.net/DosPatch_PingTest/mac/en/loading.html&quot;&gt;loading page&lt;/a&gt; uses Flash. Flash is disabled by default in Safari, so you have to be quick and click to run Flash. Alternatively, for the brave, you could edit the Safari plist file to allow Flash to run without a prompt:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# copy original plist somewhere safe&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; ~/Library/Preferences/com.apple.Safari.plist ~

&lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;plistbuddy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/usr/libexec/PlistBuddy&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# close Safari&lt;/span&gt;
killall Safari

&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/Library/Preferences/

plistbuddy &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SET ':ManagedPlugInLoadPolicies:com.macromedia.Flash Player.plugin:PlugInDisallowPromptBeforeUseDialog' false&quot;&lt;/span&gt; com.apple.Safari.plist
plistbuddy &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SET ':ManagedPlugInPolicies:com.macromedia.Flash Player.plugin:PlugInDisallowPromptBeforeUseDialog' false&quot;&lt;/span&gt; com.apple.Safari.plist
plistbuddy &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SET ':ManagedPlugInPolicies:com.macromedia.Flash Player.plugin:PlugInFirstVisitPolicy' PlugInPolicyAllowWithSecurityRestrictions&quot;&lt;/span&gt; com.apple.Safari.plist

&lt;span class=&quot;c&quot;&gt;# These keys may not be set or Flash not installed, then this won't work.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If the changes take, then run the script and you won't need to activate Flash real quick.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Once done:&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# close Safari&lt;/span&gt;
killall Safari

&lt;span class=&quot;c&quot;&gt;# copy original back&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; ~/com.apple.Safari.plist ~/Library/Preferences/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;premonition info&quot;&gt;&lt;div class=&quot;fa fa-info-circle&quot;&gt;&lt;/div&gt;&lt;div class=&quot;content&quot;&gt;&lt;p class=&quot;header&quot;&gt;Duuuh&lt;/p&gt;&lt;p&gt;Thinking about it, that loading page isn’t actually doing anything, so there’s no need to open it in Safari or mess about with the plist!&lt;/p&gt;


&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-iperf&quot;&gt;
      &lt;p&gt;Must be &lt;a href=&quot;https://downloads.sourceforge.net/project/iperf/iperf-2.0.5.tar.gz&quot;&gt;iperf2&lt;/a&gt;. &lt;a href=&quot;#fnref:fn-iperf&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:fn-upnpc&quot;&gt;
      &lt;p&gt;upnpc files &lt;a href=&quot;https://miniupnp.tuxfamily.org/&quot;&gt;here&lt;/a&gt;. &lt;a href=&quot;#fnref:fn-upnpc&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="HKBN" /><category term="macOS" /><category term="iperf" /><category term="upnpc" /><category term="bash" /><category term="AppleScript" /><category term="speedtest" /><summary type="html">Reverse Engineered HKBN Speed Test for macOS.</summary></entry><entry><title type="html">Debugging PHP with VS Code, Vagrant and Xdebug</title><link href="https://stouty.xyz/webdev/2018/07/14/vagrant-vscode-php-xdebug/" rel="alternate" type="text/html" title="Debugging PHP with VS Code, Vagrant and Xdebug" /><published>2018-07-14T12:04:28+08:00</published><updated>2018-07-14T12:04:28+08:00</updated><id>https://stouty.xyz/webdev/2018/07/14/vagrant-vscode-php-xdebug</id><content type="html" xml:base="https://stouty.xyz/webdev/2018/07/14/vagrant-vscode-php-xdebug/">&lt;p&gt;How to configure &lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;VS Code&lt;/a&gt; and &lt;a href=&quot;https://xdebug.org/&quot;&gt;Xdebug&lt;/a&gt; to debug &lt;a href=&quot;http://www.php.net/&quot;&gt;PHP&lt;/a&gt;&lt;sup id=&quot;fnref:fn-https&quot;&gt;&lt;a href=&quot;#fn:fn-https&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; running in a &lt;a href=&quot;https://www.vagrantup.com/&quot;&gt;Vagrant&lt;/a&gt; box.&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/jamesstout/fd6eae2b2ba34e7f32ff3e1a179d55fe.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Finally:&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/vagrant-vscode-php-xdebug/debugging.png&quot; src=&quot;/assets/images/posts/vagrant-vscode-php-xdebug/debugging-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;VSCode screenshot&quot; /&gt;
&lt;span style=&quot;font-size: 0.6em;&quot;&gt;&lt;a href=&quot;/assets/images/posts/vagrant-vscode-php-xdebug/debugging.png&quot;&gt;[Biggify]&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-https&quot;&gt;
      &lt;p&gt;What? No HTTPS PHP.net? &lt;a href=&quot;https://httpsiseasy.com/&quot;&gt;Come on&lt;/a&gt;… &lt;a href=&quot;#fnref:fn-https&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="vagrant" /><category term="vscode" /><category term="php" /><category term="xdebug" /><summary type="html">Configure Xdebug, Visual Studio Code for a Vagrant VM</summary></entry><entry><title type="html">HTTP vs HTTPS Test</title><link href="https://stouty.xyz/internet/2018/07/08/httpvshttps/" rel="alternate" type="text/html" title="HTTP vs HTTPS Test" /><published>2018-07-08T10:37:01+08:00</published><updated>2018-07-08T10:37:01+08:00</updated><id>https://stouty.xyz/internet/2018/07/08/httpvshttps</id><content type="html" xml:base="https://stouty.xyz/internet/2018/07/08/httpvshttps/">&lt;blockquote&gt;
  &lt;p&gt;Encrypted Websites Protect Our Privacy and are Significantly Faster.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://www.httpvshttps.com/&quot;&gt;HTTP vs HTTPS Test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/httpvshttps/httpvshttps.png&quot; src=&quot;/assets/images/posts/httpvshttps/httpvshttps-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;httpvshttps screenshot&quot; /&gt;&lt;/p&gt;</content><author><name>James Stout</name></author><category term="https" /><summary type="html">Encrypted Websites Protect Our Privacy and are Significantly Faster.</summary></entry><entry><title type="html">Neofetch</title><link href="https://stouty.xyz/macos/2018/07/08/neofetch/" rel="alternate" type="text/html" title="Neofetch" /><published>2018-07-08T10:05:01+08:00</published><updated>2018-07-08T10:05:01+08:00</updated><id>https://stouty.xyz/macos/2018/07/08/neofetch</id><content type="html" xml:base="https://stouty.xyz/macos/2018/07/08/neofetch/">&lt;p&gt;&lt;a href=&quot;https://github.com/dylanaraps/neofetch&quot;&gt;Neofetch&lt;/a&gt; is a command-line system information tool written in bash 3.2+.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Neofetch displays information about your operating system, software and hardware in an aesthetic and visually pleasing way.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Here’s my MacBook Air info:&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/neofetch/neofetch.png&quot; src=&quot;/assets/images/posts/neofetch/neofetch-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;neofetch screenshot&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Neofetch supports almost 150 different operating systems. From Linux to Windows, all the way to more obscure operating systems like Minix, AIX and Haiku.&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>James Stout</name></author><category term="neofetch" /><category term="github" /><summary type="html">Neofetch is a command-line system information tool written in bash 3.2+.</summary></entry><entry><title type="html">Creative Selection: Inside Apple’s Design Process During the Golden Age of Steve Jobs</title><link href="https://stouty.xyz/links/2018/07/08/creative-selection/" rel="alternate" type="text/html" title="Creative Selection: Inside Apple's Design Process During the Golden Age of Steve Jobs" /><published>2018-07-08T09:40:01+08:00</published><updated>2018-07-08T09:40:01+08:00</updated><id>https://stouty.xyz/links/2018/07/08/creative-selection</id><content type="html" xml:base="https://stouty.xyz/links/2018/07/08/creative-selection/"></content><author><name>James Stout</name></author><category term="link" /><summary type="html"></summary></entry><entry><title type="html">Essential macOS Software: Suspicious Package</title><link href="https://stouty.xyz/macos/2018/05/05/suspicious-package/" rel="alternate" type="text/html" title="Essential macOS Software: Suspicious Package" /><published>2018-05-05T12:29:01+08:00</published><updated>2018-05-05T12:29:01+08:00</updated><id>https://stouty.xyz/macos/2018/05/05/suspicious-package</id><content type="html" xml:base="https://stouty.xyz/macos/2018/05/05/suspicious-package/">&lt;p&gt;I always try to view package contents when I download a &lt;code class=&quot;highlighter-rouge&quot;&gt;.pkg&lt;/code&gt; file, with something like &lt;a href=&quot;https://www.charlessoft.com/&quot;&gt;Pacifist&lt;/a&gt;. The other day, doing that installed some malware:&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/suspicious-package/malware.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;malware screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I hadn’t run it, just opened in Pacifist. &lt;a href=&quot;https://www.bitdefender.com/solutions/antivirus-for-mac.html&quot;&gt;Bitdefender&lt;/a&gt; caught and deleted it, but it’s the first time I’ve seen malware on my Mac.&lt;/p&gt;

&lt;p&gt;After that scare, I found &lt;a href=&quot;http://www.mothersruin.com/software/SuspiciousPackage/&quot;&gt;Suspicious Package&lt;/a&gt; from Mothers Ruin Software:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Suspicious Package: An Application for Inspecting macOS Installer Packages&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Do you know what files that macOS Installer package actually installs?&lt;/li&gt;
    &lt;li&gt;Do you know what scripts it runs during installation, and what they do?&lt;/li&gt;
    &lt;li&gt;Do you know who the package really came from?&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;With Suspicious Package, you can answer these questions and more. Maybe you’re quite literally suspicious of a package you’ve downloaded. Or perhaps you’re just curious about what some package does. Or maybe you want to find out after the fact exactly what files a package scattered across your computer. Whatever the reason, Suspicious Package allows you to see inside an installer package. (And it’s completely free.)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/suspicious-package/app-snap.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;Suspicious Package screenshot&quot; /&gt;
&lt;span style=&quot;font-size: 0.6em;&quot;&gt;&lt;a href=&quot;/assets/images/posts/suspicious-package/app-snap.png&quot;&gt;[Biggify]&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;div class=&quot;premonition warning&quot;&gt;&lt;div class=&quot;fa fa-exclamation-circle&quot;&gt;&lt;/div&gt;&lt;div class=&quot;content&quot;&gt;&lt;p class=&quot;header&quot;&gt;TIP&lt;/p&gt;&lt;p&gt;Be suspicious. Use Suspicious Package from Mothers Ruin Software.&lt;/p&gt;


&lt;/div&gt;&lt;/div&gt;</content><author><name>James Stout</name></author><category term="macOS" /><category term="software" /><category term="malware" /><summary type="html">Be suspicious. Use Suspicious Package from Mothers Ruin Software.</summary></entry><entry><title type="html">APFS Snapshots Saved The Day</title><link href="https://stouty.xyz/macos/2018/05/01/apfs-snapshots/" rel="alternate" type="text/html" title="APFS Snapshots Saved The Day" /><published>2018-05-01T09:29:01+08:00</published><updated>2018-05-01T09:29:01+08:00</updated><id>https://stouty.xyz/macos/2018/05/01/apfs-snapshots</id><content type="html" xml:base="https://stouty.xyz/macos/2018/05/01/apfs-snapshots/">&lt;p&gt;I had a shocker earlier with an out of control&lt;sup id=&quot;fnref:fn-bad-code&quot;&gt;&lt;a href=&quot;#fn:fn-bad-code&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; shell script that was supposed to tidy up a load of empty directories on my Mac. Just in my home dir I had nearly 18,000 empty directories:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-not&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; .svn &lt;span class=&quot;nt&quot;&gt;-prune&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; .git &lt;span class=&quot;nt&quot;&gt;-prune&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; d &lt;span class=&quot;nt&quot;&gt;-empty&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
   17825
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I wrote a &lt;em&gt;test&lt;/em&gt; script to try out on a few directories. The next thing I saw … &lt;code class=&quot;highlighter-rouge&quot;&gt;rm -rf /&lt;/code&gt; commands whizzing past on my terminal. Then things stopped working: &lt;code class=&quot;highlighter-rouge&quot;&gt;bash&lt;/code&gt; had been deleted.&lt;/p&gt;

&lt;p&gt;I use &lt;a href=&quot;https://brew.sh/&quot;&gt;Homebrew&lt;/a&gt; so &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local&lt;/code&gt; is writable by my user. And deletable. So my &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/bin&lt;/code&gt; dir was gone, along with some other files.&lt;/p&gt;

&lt;p&gt;I’m a proper backup nerd and have multiple backup strategies:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Time_Machine_(macOS)&quot;&gt;Time Machine&lt;/a&gt; to my &lt;a href=&quot;https://www.synology.com/en-global/products/DS1817+&quot;&gt;NAS&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.econtechnologies.com/chronosync/overview.html&quot;&gt;ChronoSync&lt;/a&gt; to a &lt;a href=&quot;https://www.docker.com/&quot;&gt;Docker&lt;/a&gt; container running &lt;a href=&quot;https://www.crashplan.com/en-us/business/&quot;&gt;CrashPlan&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://secure.backblaze.com/r/001z1s&quot;&gt;Backblaze&lt;/a&gt;.&lt;sup id=&quot;fnref:fn-ref-link&quot;&gt;&lt;a href=&quot;#fn:fn-ref-link&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
  &lt;li&gt;Finally, and this is what let me down, a &lt;a href=&quot;https://bombich.com/&quot;&gt;Carbon Copy&lt;/a&gt; clone of my main drive.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The clone was a few weeks old, my &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local&lt;/code&gt; changes all the time. It wasn’t usable.&lt;/p&gt;

&lt;div class=&quot;premonition warning&quot;&gt;&lt;div class=&quot;fa fa-exclamation-circle&quot;&gt;&lt;/div&gt;&lt;div class=&quot;content&quot;&gt;&lt;p class=&quot;header&quot;&gt;TIP&lt;/p&gt;&lt;p&gt;Clone your drive often and test that it &lt;a href=&quot;https://bombich.com/kb/ccc5/how-verify-or-test-your-backup&quot;&gt;works&lt;/a&gt;!&lt;/p&gt;


&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, I’d been learning about APFS, and had taken a snapshot .. yesterday.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/APFS_Guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40016999-CH1-DontLinkElementID_19&quot;&gt;APFS&lt;/a&gt; is Apple’s new filesystem:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Apple File System is a new, modern file system for iOS, macOS, tvOS, and watchOS. It is optimized for Flash/SSD storage and features strong encryption, copy-on-write metadata, space sharing, cloning for files and directories, snapshots, fast directory sizing, atomic safe-save primitives, and improved file system fundamentals.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;What’s a &lt;a href=&quot;https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/APFS_Guide/Features/Features.html#//apple_ref/doc/uid/TP40016999-CH5-DontLinkElementID_5&quot;&gt;snapshot&lt;/a&gt;?&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;A volume snapshot is a point-in-time, read-only instance of the file system.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Time Machine also takes local snapshots if your &lt;a href=&quot;https://support.apple.com/en-hk/HT204015&quot;&gt;backup drive isn’t available&lt;/a&gt;, so I actually had a few snapshots:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmutil listlocalsnapshots /
com.apple.TimeMachine.2018-04-30-165525
com.apple.TimeMachine.2018-04-30-175518
com.apple.TimeMachine.2018-04-30-185503
com.apple.TimeMachine.2018-04-30-195506
com.apple.TimeMachine.2018-04-30-205509
com.apple.TimeMachine.2018-04-30-215522
com.apple.TimeMachine.2018-04-30-225512
com.apple.TimeMachine.2018-04-30-235517
com.apple.TimeMachine.2018-05-01-005520
com.apple.TimeMachine.2018-05-01-015548
com.apple.TimeMachine.2018-05-01-025524
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can use &lt;code class=&quot;highlighter-rouge&quot;&gt;tmutil&lt;/code&gt; to &lt;a href=&quot;http://krypted.com/mac-os-x/ins-outs-using-tmutil-backup-restore-review-time-machine-backups/&quot;&gt;compare and restore&lt;/a&gt;, or simply Time Machine, but the files are available right there on the filesystem, I just had to copy my missing files back into the right places from the local snapshot dir:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /Volumes/com.apple.TimeMachine.localsnapshots/Backups.backupdb/James’s&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;iMac/2018-05-01-025524/Macintosh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;HD/usr/local/

james@Jamess-iMac: /Volumes/com.apple.TimeMachine.localsnapshots/Backups.backupdb/James’s iMac/2018-05-01-025524/Macintosh HD/usr/local
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;Caskroom      Frameworks    MacGPG2       etc           lib           opt           remotedesktop share
Cellar        Homebrew      bin           include       man           pear          sbin          var
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Phew. All fixed.&lt;/p&gt;

&lt;p&gt;Do I like APFS?&lt;/p&gt;

&lt;video width=&quot;240&quot; height=&quot;240&quot; autoplay=&quot;&quot; muted=&quot;&quot; loop=&quot;&quot; playsinline=&quot;&quot; poster=&quot;/assets/images/posts/apfs-snapshots/bale.gif&quot;&gt;
  &lt;source src=&quot;/assets/images/posts/apfs-snapshots/bale.mp4&quot; type=&quot;video/mp4&quot; /&gt;
  Your browser does not support the video tag.
&lt;/video&gt;

&lt;hr /&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-bad-code&quot;&gt;
      &lt;p&gt;Er, poorly written. &lt;a href=&quot;#fnref:fn-bad-code&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:fn-ref-link&quot;&gt;
      &lt;p&gt;Referral link. &lt;a href=&quot;#fnref:fn-ref-link&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="APFS" /><category term="macOS" /><category term="snapshots" /><category term="filesystems" /><category term="tmutil" /><summary type="html">The perils of `rm -rf` and the wonder of filesystem snapshots.</summary></entry><entry><title type="html">Prince estate releases original version of ‘Nothing Compares 2 U’</title><link href="https://stouty.xyz/music/2018/04/22/prince/" rel="alternate" type="text/html" title="Prince estate releases original version of 'Nothing Compares 2 U'" /><published>2018-04-22T19:36:01+08:00</published><updated>2018-04-22T19:36:01+08:00</updated><id>https://stouty.xyz/music/2018/04/22/prince</id><content type="html" xml:base="https://stouty.xyz/music/2018/04/22/prince/">&lt;!-- Courtesy of embedresponsively.com //--&gt;
&lt;div class=&quot;responsive-video-container&quot;&gt;

  &lt;iframe src=&quot;https://www.youtube.com/embed/cpGA0azFdCs&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;/div&gt;

&lt;p&gt;[&lt;a href=&quot;https://www.dailydot.com/upstream/prince-estate-original-nothing-compares-2-u/&quot;&gt;Link&lt;/a&gt;]&lt;/p&gt;</content><author><name>James Stout</name></author><category term="music" /><category term="youtube" /><category term="prince" /><summary type="html">{% include video id=”cpGA0azFdCs” provider=”youtube” %}</summary></entry><entry><title type="html">Westworld: Eight Lingering Questions from Season 1</title><link href="https://stouty.xyz/links/2018/04/22/westworld-catchup/" rel="alternate" type="text/html" title="Westworld: Eight Lingering Questions from Season 1" /><published>2018-04-22T18:58:01+08:00</published><updated>2018-04-22T18:58:01+08:00</updated><id>https://stouty.xyz/links/2018/04/22/westworld-catchup</id><content type="html" xml:base="https://stouty.xyz/links/2018/04/22/westworld-catchup/"></content><author><name>James Stout</name></author><category term="link" /><summary type="html"></summary></entry></feed>