<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://stouty.xyz/feed.xml" rel="self" type="application/atom+xml" /><link href="https://stouty.xyz/" rel="alternate" type="text/html" /><updated>2020-05-17T21:13:51+08:00</updated><id>https://stouty.xyz/feed.xml</id><title type="html">stouty.xyz</title><subtitle>James Stout. iOS. Web developer. Tech, crypto, comedy, Hong Kong, hcafc, smashing telly and, of course, the weather.</subtitle><author><name>James Stout</name></author><entry><title type="html">Fixing Nextcloud Conflicting Files</title><link href="https://stouty.xyz/nextcloud/2020/05/17/nextcloud-conflicting-files/" rel="alternate" type="text/html" title="Fixing Nextcloud Conflicting Files" /><published>2020-05-17T21:00:30+08:00</published><updated>2020-05-17T21:00:30+08:00</updated><id>https://stouty.xyz/nextcloud/2020/05/17/nextcloud-conflicting-files</id><content type="html" xml:base="https://stouty.xyz/nextcloud/2020/05/17/nextcloud-conflicting-files/">&lt;p&gt;I made a bit of a mess with my Nextcloud sync yesterday. I have my Dropbox folder synced to my Mac Nextcloud folder, but not to the sync folder on my NAS. I thought I would save time and bandwidth by copying the folder from my Mac to my NAS and seeing if the sync could figure it out.&lt;/p&gt;

&lt;p&gt;It didn’t.&lt;/p&gt;

&lt;p&gt;I ended up with loads of conflicts. For example:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Volumes/docker/nextcloud/media/Dropbox/Code/HKWarnings
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*conflict*'&lt;/span&gt;
./Classes/AboutViewControlleriPad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/AboutViewControlleriPad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/AboutViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/Acknowledgements_iPhoneViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-28 103701&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/Constants &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/DisclaimerViewController2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/DetailViewController2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/FCReachability &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/ForecastViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/GetHistoricalWarnings &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/GADMasterViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HKWWarnings &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HKWPhotosViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-14 193739&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/HKWarningsWeatherImages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-11 083931&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HKWPhotosViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-14 193739&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HKWeatherWarningsTabsAppDelegate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/HKWeatherWarningsTabsAppDelegate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HomeViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/HKWeatherWarningsiPadAppDelegate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/HKWeatherWarningsiPadAppDelegate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-16 172756&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/HomeViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-05 135634&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/InAppPurchaseViewController2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/InAppPurchaseManager &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/InAppPurchaseViewController_iPad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/MYUIActivityItemProvider &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/MyUIActivity &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/NSDate+HKWUtilities &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/NSMutableString+HKWUtilities &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-08 172828&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/NSDate+HKWUtilities &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/NSObject+JSON &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/NSString_HKWUtilities &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/NSString_HKWUtilities &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/PopoverContentViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/OptOutViewController_iPad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/OptOutViewController_iPhone &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/PushSettingsViewController_iPad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-20 100727&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/RadarViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/RadarViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/PushSettingsViewController_iPhone &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-04-28 103701&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
./Classes/RadarViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.xib
./Classes/SatViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.h
./Classes/SatViewController &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2020-05-03 151942&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In total:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Volumes/docker/nextcloud/media/Dropbox
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*conflict*'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
     620
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Right. I couldn’t fix them manually, or at least didn’t want to.&lt;/p&gt;

&lt;p&gt;Script time.&lt;/p&gt;

&lt;p&gt;The script below has been though a few iterations, to deal with spaces in filenames/directories, and files without an extension. It mostly works, but some files fail, and maybe some symlinks.&lt;/p&gt;

&lt;p&gt;Now:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Volumes/docker/nextcloud/media/Dropbox
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*conflict*'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
      10
james@Jamess-iMac: /Volumes/docker/nextcloud/media/Dropbox
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'*conflict*'&lt;/span&gt;
./Apps/Yojimbo/Database.bbyojimbostorage/Contents/Database/Database &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Jamess-iMac&lt;span class=&quot;s1&quot;&gt;'s conflicted copy 2018-07-07).sqlite
./Apps/Yojimbo/Database.bbyojimbostorage/Contents/Database/Database (Jamess-iMac'&lt;/span&gt;s conflicted copy 2018-07-07&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.sqlite-shm
./Apps/Yojimbo/Database.bbyojimbostorage/Contents/Database/Database &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Jamess-iMac&lt;span class=&quot;s1&quot;&gt;'s conflicted copy 2018-07-07).sqlite-wal
./Apps/Yojimbo/State (Jamess-MacBook-Air'&lt;/span&gt;s conflicted copy 2020-03-25&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.plist
./Apps/Yojimbo/State &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Jamess-iMac&lt;span class=&quot;s1&quot;&gt;'s conflicted copy 2020-01-24).plist
./Apps/Yojimbo/State (Jamess-iMac'&lt;/span&gt;s conflicted copy 2020-03-25&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.plist
./Code/HKWarnings-server/1604/etc/monit/conf-available/mysql &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2017-11-28 110223&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
./Code/HKWarnings-server/1604/etc/monit/conf-available/rsyslog &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2017-11-28 110223&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
./Code/HKWarnings-server/nginx-config.io/sites-enabled/01_stouty.xyz &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2019-10-11 110101&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.conf
./Code/HKWarnings-server/nginx-config.io/sites-enabled/02_hkwarnings.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;conflicted copy 2019-10-11 110125&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The last 4 are symlinks. Not sure about the others.&lt;/p&gt;</content><author><name>James Stout</name></author><category term="nextcloud" /><category term="bash" /><category term="stat" /><category term="find" /><category term="sync" /><summary type="html">A bash script to correct conflicting files.</summary></entry><entry><title type="html">Firebase Crashlytics - Are They Having a Laugh?</title><link href="https://stouty.xyz/ios/2020/05/15/firebase-crashlytics/" rel="alternate" type="text/html" title="Firebase Crashlytics - Are They Having a Laugh?" /><published>2020-05-15T22:22:55+08:00</published><updated>2020-05-15T22:22:55+08:00</updated><id>https://stouty.xyz/ios/2020/05/15/firebase-crashlytics</id><content type="html" xml:base="https://stouty.xyz/ios/2020/05/15/firebase-crashlytics/">&lt;p&gt;Crash reporting is an important part of app development, you don’t want your app to crash on users, so when it does it’s important to know when and why and be able to fix the issue.&lt;/p&gt;

&lt;p&gt;I was a beta tester for &lt;a href=&quot;https://en.wikipedia.org/wiki/Crashlytics&quot;&gt;Crashlytics&lt;/a&gt; back in 2012, exchanging emails with &lt;a href=&quot;https://en.wikipedia.org/wiki/Wayne_Chang&quot;&gt;Wayne Chang&lt;/a&gt;, one of the founders:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/firebase-crashlytics/wayne.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/firebase-crashlytics/wayne.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;wayne chang email&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We exchanged feedback for a few months as they rolled out the SDK and the Mac app.&lt;/p&gt;

&lt;p&gt;I like to think I was, in part, responsible for getting rid of the awful zipper thing they had on early versions of the crash report Web page:&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/firebase-crashlytics/zipper.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;wayne chang email&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I think &lt;a href=&quot;https://xconomy.com/boston/2013/02/05/twitters-boston-acquisitions-crashlytics-tops-100m-bluefin-labs-close-behind/&quot;&gt;Twitter bought them&lt;/a&gt;, then in January 2017, &lt;a href=&quot;https://fabric.io/blog/fabric-joins-google&quot;&gt;Crashlytics and Fabric were acquired by Google&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In September 2018 Google announced that &lt;a href=&quot;https://venturebeat.com/2018/09/14/google-is-killing-fabric-in-mid-2019-pushes-developers-to-firebase/&quot;&gt;Fabric will be deprecated&lt;/a&gt; and developers should use Crashlytics via Firebase.&lt;/p&gt;

&lt;p&gt;They’re a little late on their roadmap (by a year or so), but finally, this week:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/firebase-crashlytics/fabric.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/firebase-crashlytics/fabric.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;fabruc shutdown&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Developers have until November 15th 2020 for migrate to &lt;a href=&quot;https://firebase.google.com/docs/crashlytics&quot;&gt;Firebase Crashlytics&lt;/a&gt;, or, another crash reporter.&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/firebase-crashlytics/fabric2.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;fabric2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The current Fabric/Crashlytics SDK still works, you just have to go to the Firebase console to see the crash report. I currently have one outstanding crash in an old version, due to &lt;a href=&quot;http://www.qnx.com/developers/docs/qnxcar2/index.jsp?topic=%2Fcom.qnx.doc.neutrino.prog%2Ftopic%2Fhat_ProblemsWithHeapCorruption.html&quot;&gt;heap corruption&lt;/a&gt;. Here’s an example of some of the data you can get:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/cr1.png&quot; title=&quot;Example crash report&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/cr1-th.png&quot; alt=&quot;Example crash report&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/cr2.png&quot; title=&quot;Example crash report&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/cr2-th.png&quot; alt=&quot;Example crash report&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/cr3.png&quot; title=&quot;Example crash report&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/cr3-th.png&quot; alt=&quot;Example crash report&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/cr4.png&quot; title=&quot;Example crash report&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/cr4-th.png&quot; alt=&quot;Example crash report&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;Anyway, to the point of this post. The migration guide says to simply switch your Pods, add the plist and change the way you initiate the shared Crashlytics object:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Add the pod for Firebase Crashlytics&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Firebase/Crashlytics'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But check out what else it installs:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/iPhone Apps/HKWarnings on fb[!&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pod &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--no-repo-update&lt;/span&gt;
Analyzing dependencies
Downloading dependencies
Installing Firebase &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6.24.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseAnalyticsInterop &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.5.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseCore &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6.7.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseCoreDiagnostics &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.3.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseCoreDiagnosticsInterop &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseCrashlytics &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing FirebaseInstallations &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing GoogleDataTransport &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing GoogleDataTransportCCTSupport &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Installing GoogleUtilities 6.6.0
Removing Crashlytics
Removing Fabric
Generating Pods project
Integrating client project
Pod installation &lt;span class=&quot;nb&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; There are 23 dependencies from the Podfile and 38 total pods installed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Extra pods installed:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Firebase/CoreOnly (6.24.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCore (= 6.7.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Firebase/Crashlytics (6.24.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Firebase/CoreOnly&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCrashlytics (~&amp;gt; 4.1.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseAnalyticsInterop (1.5.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCore (6.7.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCoreDiagnostics (~&amp;gt; 1.3)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCoreDiagnosticsInterop (~&amp;gt; 1.2)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Environment (~&amp;gt; 6.5)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Logger (~&amp;gt; 6.5)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCoreDiagnostics (1.3.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCoreDiagnosticsInterop (~&amp;gt; 1.2)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransportCCTSupport (~&amp;gt; 3.1)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Environment (~&amp;gt; 6.5)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Logger (~&amp;gt; 6.5)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nanopb (~&amp;gt; 1.30905.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCoreDiagnosticsInterop (1.2.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCrashlytics (4.1.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseAnalyticsInterop (~&amp;gt; 1.2)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCore (~&amp;gt; 6.6)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseInstallations (~&amp;gt; 1.1)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransport (~&amp;gt; 6.1)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransportCCTSupport (~&amp;gt; 3.1)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nanopb (~&amp;gt; 1.30905.0)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;PromisesObjC (~&amp;gt; 1.2)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseInstallations (1.2.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;FirebaseCore (~&amp;gt; 6.6)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Environment (~&amp;gt; 6.6)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/UserDefaults (~&amp;gt; 6.6)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;PromisesObjC (~&amp;gt; 1.2)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransport (6.1.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransportCCTSupport (3.1.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleDataTransport (~&amp;gt; 6.1)&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nanopb (~&amp;gt; 1.30905.0)&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/UserDefaults (6.6.0)&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;GoogleUtilities/Logger&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;665 extra files, 3MB, Xcode build tasks go from 740 to 1600.&lt;/p&gt;

&lt;p&gt;Build time goes from 43 to 70 seconds, 60% longer.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What are all those files doing?!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;You can check out the full &lt;a href=&quot;https://github.com/firebase/firebase-ios-sdk&quot;&gt;Firebase platform on GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Anyway, I’m not very keen, but I’ll give it a go. You can see how many iterations of the SDKs I’ve been through by the commented code:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;@try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//[Crashlytics startWithAPIKey:kCrashlyticsKey];&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//[[Fabric sharedSDK] setDebug: FABRIC_DEBUG];&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//[Fabric with:@[CrashlyticsKit]];&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//[[Fabric with:@[[Crashlytics class]]] setDebug:FABRIC_DEBUG];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FIRApp&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;@catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NSLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;[FIRApp configure]; Caught %@: %@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;startedCrashlytics&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Verbose logging from the SDK. It’s doing a lot, including downloading settings and logging each screen (even though it does nothing with it as I didn’t install Firebase Analytics).&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/jamesstout/444216d80bff511c96aa7927e8c73b55.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Build artifacts and app sizes:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/archive-no-firebase.png&quot; title=&quot;archive-no-firebase&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/archive-no-firebase-th.png&quot; alt=&quot;archive-no-firebase&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/archive-with-firebase.png&quot; title=&quot;archive-with-firebase&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/archive-with-firebase-th.png&quot; alt=&quot;archive-with-firebase&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/build-no-firebase.png&quot; title=&quot;build-no-firebase&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/build-no-firebase-th.png&quot; alt=&quot;build-no-firebase&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/firebase-crashlytics/build-with-firebase.png&quot; title=&quot;build-with-firebase&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/firebase-crashlytics/build-with-firebase-th.png&quot; alt=&quot;build-with-firebase&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;1MB or so larger binary and dSYM.&lt;/p&gt;

&lt;p&gt;There’s just too much going on that isn’t clear or documented. I’m going to have to look for alternatives.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.bugsnag.com/platforms/ios-crash-reporting&quot;&gt;Bugsnag&lt;/a&gt; - free for up to 7500 events.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://count.ly/&quot;&gt;Countly&lt;/a&gt; - looks good, open source, free and self-hosted.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://sentry.io/&quot;&gt;Sentry&lt;/a&gt; - Uses Pod frameworks or &lt;a href=&quot;https://github.com/Carthage/Carthage&quot;&gt;Carthage&lt;/a&gt;, and a &lt;a href=&quot;https://github.com/getsentry/sentry-cocoa/releases&quot;&gt;16MB framework&lt;/a&gt;…🧐&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I think I’ll check out Countly first.&lt;/p&gt;</content><author><name>James Stout</name></author><category term="iOS" /><category term="crash reporting" /><category term="Firebase" /><category term="Crashlytics" /><summary type="html">Investigating the new Firebase Crashlytics SDK.</summary></entry><entry><title type="html">A Jekyll Hook to Copy Pre-Built Site to Another Directory</title><link href="https://stouty.xyz/webdev/2020/05/11/copy-site-jekyll-hook/" rel="alternate" type="text/html" title="A Jekyll Hook to Copy Pre-Built Site to Another Directory" /><published>2020-05-11T23:42:03+08:00</published><updated>2020-05-11T23:42:03+08:00</updated><id>https://stouty.xyz/webdev/2020/05/11/copy-site-jekyll-hook</id><content type="html" xml:base="https://stouty.xyz/webdev/2020/05/11/copy-site-jekyll-hook/">&lt;p&gt;This &lt;a href=&quot;https://stouty.xyz/webdev/2020/04/28/git-deploy/&quot;&gt;site&lt;/a&gt; doesn’t build as a &lt;a href=&quot;https://pages.github.com/&quot;&gt;GitHub Page&lt;/a&gt; as it uses &lt;a href=&quot;https://pages.github.com/versions/&quot;&gt;unsupported gems and plugins&lt;/a&gt;. So when I push to &lt;code class=&quot;highlighter-rouge&quot;&gt;jamesstout.github.io.git&lt;/code&gt; I get build failures.&lt;/p&gt;

&lt;p&gt;My solution is to have two repositories, the source where I write and build the site, and a destination repo that points to the &lt;code class=&quot;highlighter-rouge&quot;&gt;jamesstout.github.io.git&lt;/code&gt; &lt;a href=&quot;https://github.com/jamesstout/jamesstout.github.io&quot;&gt;repo&lt;/a&gt;. The difference is, the destination repo just contains the files from the already built &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; folder. This is what is pushed to the destination, and ultimately rendered at &lt;a href=&quot;https://jamesstout.github.io/&quot;&gt;jamesstout.github.io&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Not wanting to do anything manually, I wrote a &lt;a href=&quot;https://jekyllrb.com/docs/plugins/hooks/&quot;&gt;Jekyll hook plugin&lt;/a&gt; that copies the files from the &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; folder to the destination repo, commits the changes and pushes to its remote, but only if there is a new commit in the source repo. No point copying, and pushing if you haven’t yet committed your changes. Here’s the plugin:&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/jamesstout/42201bbc498a4b91a9a1f884a17ced8c.js&quot;&gt;&lt;/script&gt;</content><author><name>James Stout</name></author><category term="jekyll" /><category term="hooks" /><category term="ruby" /><category term="github.io" /><category term="jekyll plugins" /><summary type="html">My first attempt at a Jekyll plugin, it copies the `_site` folder somewhere else.</summary></entry><entry><title type="html">A Quick Update on Zoom Code Signing</title><link href="https://stouty.xyz/macos/2020/05/11/zoom-update/" rel="alternate" type="text/html" title="A Quick Update on Zoom Code Signing" /><published>2020-05-11T00:32:38+08:00</published><updated>2020-05-11T00:32:38+08:00</updated><id>https://stouty.xyz/macos/2020/05/11/zoom-update</id><content type="html" xml:base="https://stouty.xyz/macos/2020/05/11/zoom-update/">&lt;p&gt;A quick update to my previous post on &lt;a href=&quot;https://stouty.xyz/macos/2020/04/05/zoom/&quot;&gt;Zoom security&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Per &lt;a href=&quot;https://twitter.com/scotteh/&quot;&gt;@scotteh&lt;/a&gt; and @&lt;a href=&quot;https://twitter.com/patrickwardle/&quot;&gt;patrickwardle&lt;/a&gt;, you can still unsign the app and load any dylibs you like:
&lt;!-- markdownlint-disable MD034 --&gt;&lt;/p&gt;
&lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Sure!&lt;br /&gt;a) Unsign (via --remove-signature)&lt;br /&gt;b) Load any dylibs 🤭&lt;br /&gt;&lt;br /&gt;e.g.&lt;br /&gt;DYLD_INSERT_LIBRARIES=zoomzoom.dylib  /Applications/zoomzoom.us .app/Contents/MacOS/zoom.us &lt;br /&gt;&lt;br /&gt;You&amp;#39;ll have to (re)grant access to mic/webcam and notarization would be an issue if you (re)distribute though... &lt;a href=&quot;https://t.co/RReUqvXF6S&quot;&gt;pic.twitter.com/RReUqvXF6S&lt;/a&gt;&lt;/p&gt;&amp;mdash; patrick wardle (@patrickwardle) &lt;a href=&quot;https://twitter.com/patrickwardle/status/1250684302049726464?ref_src=twsrc%5Etfw&quot;&gt;April 16, 2020&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;!-- markdownlint-enable MD034 --&gt;

&lt;p&gt;Maybe I don’t understand &lt;a href=&quot;https://developer.apple.com/library/archive/documentation/Security/Conceptual/CodeSigningGuide/Procedures/Procedures.html&quot;&gt;code signing&lt;/a&gt;, &lt;a href=&quot;https://www.manpagez.com/man/8/spctl/&quot;&gt;spctl&lt;/a&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/Gatekeeper_(macOS)#Execution&quot;&gt;Gatekeeper&lt;/a&gt; well enough.&lt;/p&gt;

&lt;p&gt;Gatekeeper is on, &lt;code class=&quot;highlighter-rouge&quot;&gt;spctl&lt;/code&gt; says rejected, but Zoom still opens after removing the signature… 🧐&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;spctl &lt;span class=&quot;nt&quot;&gt;--status&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;
assessments enabled
developer &lt;span class=&quot;nb&quot;&gt;id &lt;/span&gt;enabled

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;spctl &lt;span class=&quot;nt&quot;&gt;--assess&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4 /Applications/zoom.us.app/
/Applications/zoom.us.app/: accepted
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Developer ID

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;codesign &lt;span class=&quot;nt&quot;&gt;--remove-signature&lt;/span&gt; /Applications/zoom.us.app/

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;spctl &lt;span class=&quot;nt&quot;&gt;--assess&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4 /Applications/zoom.us.app/
/Applications/zoom.us.app/: rejected
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no usable signature

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;o /Applications/zoom.us.app/

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>James Stout</name></author><category term="macOS" /><category term="Zoom" /><category term="security" /><category term="code signing" /><category term="spctl" /><summary type="html">A quick update on Zoom code signing.</summary></entry><entry><title type="html">Compress-Upload-CocoaLumberjack - My First CocoaPod</title><link href="https://stouty.xyz/ios/2020/05/09/compress-upload-cocoalumberjack/" rel="alternate" type="text/html" title="Compress-Upload-CocoaLumberjack - My First CocoaPod" /><published>2020-05-09T23:09:06+08:00</published><updated>2020-05-09T23:09:06+08:00</updated><id>https://stouty.xyz/ios/2020/05/09/compress-upload-cocoalumberjack</id><content type="html" xml:base="https://stouty.xyz/ios/2020/05/09/compress-upload-cocoalumberjack/">&lt;p&gt;I just published my first CocoaPod: &lt;a href=&quot;https://cocoapods.org/pods/Compress-Upload-CocoaLumberjack&quot;&gt;Compress-Upload-CocoaLumberjack&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Remote logging via NSURLSession transfer to upload compressed CocoaLumberjack logs to an HTTP server.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/Compress-Upload-CocoaLumberjack on master[?]
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pod trunk me
  - Name:     James Stout
  - Email:    stoutyhk@gmail.com
  - Since:    May 7th, 20:14
  - Pods:
    - Compress-Upload-CocoaLumberjack
  - Sessions:
    - May 7th, 20:14 - September 14th, 21:44. IP: 203.218.233.190 Description: imac

james@Jamess-iMac: ~/Projects/Compress-Upload-CocoaLumberjack on master[?]
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pod search Compress-Upload-CocoaLumberjack 2&amp;gt; /dev/null

-&amp;gt; Compress-Upload-CocoaLumberjack &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.1.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   Remote logging via NSURLSession transfer to upload compressed CocoaLumberjack logs to an HTTP server.
   pod &lt;span class=&quot;s1&quot;&gt;'Compress-Upload-CocoaLumberjack'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 0.1.2'&lt;/span&gt;
   - Homepage: https://github.com/jamesstout/Compress-Upload-CocoaLumberjack
   - Source:   https://github.com/jamesstout/Compress-Upload-CocoaLumberjack.git
   - Versions: 0.1.2, 0.1.1, 0.1.0 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Specs repo]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The rationale for creating this Pod was that the &lt;a href=&quot;https://github.com/CocoaLumberjack/CocoaLumberjack/tree/master/Demos/LogFileCompressor&quot;&gt;demo log file compression project&lt;/a&gt; in &lt;a href=&quot;https://github.com/CocoaLumberjack/CocoaLumberjack&quot;&gt;CocoaLumberjack&lt;/a&gt; just zips archived files, and &lt;a href=&quot;https://github.com/pushd/BackgroundUpload-CocoaLumberjack&quot;&gt;BackgroundUpload-CocoaLumberjack&lt;/a&gt; only uploads uncompressed log files. I wanted to compress, and then upload, to save space and bandwidth.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;So first things first, thank you to &lt;a href=&quot;https://github.com/pushd&quot;&gt;pushd&lt;/a&gt; and &lt;a href=&quot;https://cocoalumberjack.github.io/&quot;&gt;CocoaLumberjack&lt;/a&gt; for their work, inspiration, examples and permissive licenses. This wouldn’t exist without them.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;CocoaLumberjack is  a fast &amp;amp; simple, yet powerful &amp;amp; flexible logging framework&lt;/p&gt;

&lt;blockquote&gt;
  &lt;h2 id=&quot;lumberjack-is-fast--simple-yet-powerful--flexible&quot;&gt;Lumberjack is Fast &amp;amp; Simple, yet Powerful &amp;amp; Flexible.&lt;/h2&gt;
  &lt;p&gt;It is similar in concept to other popular logging frameworks such as log4j, yet is designed specifically for Objective-C, and takes advantage of features such as multi-threading, grand central dispatch (if available), lockless atomic operations, and the dynamic nature of the Objective-C runtime.&lt;/p&gt;

  &lt;h2 id=&quot;lumberjack-is-fast&quot;&gt;Lumberjack is Fast&lt;/h2&gt;
  &lt;p&gt;In most cases it is an order of magnitude faster than NSLog.&lt;/p&gt;

  &lt;h2 id=&quot;lumberjack-is-powerful&quot;&gt;Lumberjack is Powerful&lt;/h2&gt;
  &lt;p&gt;One log statement can be sent to multiple loggers, meaning you can log to a file and the console simultaneously. Want more? Create your own loggers (it’s easy) and send your log statements over the network. Or to a database or distributed file system. The sky is the limit.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Check out the &lt;a href=&quot;https://github.com/CocoaLumberjack/CocoaLumberjack/blob/master/Documentation/Performance.md&quot;&gt;benchmarks&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The default philosophy for asynchronous logging is very simple:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Log messages with errors should be executed synchronously.&lt;/li&gt;
  &lt;li&gt;All other log messages, such as debug output, are executed asynchronously.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Getting started is simple. This will add a pair of “loggers” and your log statements will be sent to the Console.app and the Xcode console (just like a normal &lt;code class=&quot;highlighter-rouge&quot;&gt;NSLog&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define LOG_LEVEL_DEF ddLogLevel
#import &amp;lt;CocoaLumberjack/CocoaLumberjack.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDOSLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sharedInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To add another logger, one that writes to a file:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;DDFileLogger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDFileLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rollingFrequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 24 hour rolling&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumNumberOfLogFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That’s a fairly standard log file setup, with one file per day, for a week. After a week, the oldest file is deleted.&lt;/p&gt;

&lt;p&gt;Then to log, just convert your &lt;code class=&quot;highlighter-rouge&quot;&gt;NSLog&lt;/code&gt; calls:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Convert from this:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NSLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Broken sprocket detected!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NSLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;User selected file:%@ withSize:%u&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fileSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// To this:&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DDLogError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Broken sprocket detected!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DDLogVerbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;User selected file:%@ withSize:%u&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fileSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Those logs will be set to the console, and to the log file.&lt;/p&gt;

&lt;p&gt;If you make the &lt;code class=&quot;highlighter-rouge&quot;&gt;logFileManager&lt;/code&gt; a &lt;code class=&quot;highlighter-rouge&quot;&gt;CompressingLogFileManager&lt;/code&gt;, per the LogFileCompressor demo project mentioned above, your setup looks like this:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;CompressingLogFileManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CompressingLogFileManager&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDFileLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initWithLogFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 1kB and 1 min, just to demo quick rolling/compressing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumFileSize&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 1 KB&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rollingFrequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 1 Minute&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumNumberOfLogFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDOSLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sharedInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this setup, your log file is ‘archived’ and then compressed to a &lt;code class=&quot;highlighter-rouge&quot;&gt;.gz&lt;/code&gt; file. After a while, the log folder looks like this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/compress-upload-cocoalumberjack/log-folder.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/log-folder.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;log-folder&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Seems the &lt;code class=&quot;highlighter-rouge&quot;&gt;.gz&lt;/code&gt; files are excluded from the deletion based on &lt;code class=&quot;highlighter-rouge&quot;&gt;maximumNumberOfLogFiles&lt;/code&gt;, so the folder would just fill up, I think.&lt;/p&gt;

&lt;p&gt;I deal with this in Compress-Upload-CocoaLumberjack. To set up Compress-Upload-CocoaLumberjack, you need an HTTP(S) server with an endpoint that accepts the log files, then instantiate the logger with your URL:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// change the URL to your domain/endpoint&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NSMutableURLRequest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSMutableURLRequest&lt;/span&gt;
                                    &lt;span class=&quot;nl&quot;&gt;requestWithURL:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURL&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLWithString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;http://localhost:3000/log&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setHTTPMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CompressingAndUploadingLogFileManager&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initWithUploadRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDFileLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initWithLogFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// set to 1 min and 1kB so they roll quickly&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumFileSize&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 1 KB&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rollingFrequency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 1 Minute&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximumNumberOfLogFiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDOSLogger&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sharedInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLog&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;addLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The compression behaviour is the same as in LogFileCompressor, except in &lt;code class=&quot;highlighter-rouge&quot;&gt;compressionDidSucceed&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#pragma mark - compressionDidSucceed
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;compressionDidSucceed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLogFileInfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;logFile&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NSLogVerbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;CompressingAndUploadingLogFileManager: compressionDidSucceed: %@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
    &lt;span class=&quot;c1&quot;&gt;// at this point we want to upload logFile, if the dontUpload flag isn't set&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doUpload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;uploadArchivedFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isCompressing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;compressNextLogFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;uploadArchivedFile&lt;/code&gt; eventually calls:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;uploadLogFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;logFilePath&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NSMutableURLRequest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uploadRequest&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mutableCopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFilePath&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;stringByAddingPercentEncodingWithAllowedCharacters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSCharacterSet&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLHostAllowedCharacterSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forHTTPHeaderField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;X-BackgroundUpload-File&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// added extra header to identify upload&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;currentDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;identifierForVendor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UUIDString&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;stringByAddingPercentEncodingWithAllowedCharacters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSCharacterSet&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLHostAllowedCharacterSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forHTTPHeaderField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;X-BackgroundUpload-File-UUID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  
    &lt;span class=&quot;n&quot;&gt;NSURLSessionTask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;uploadTaskWithRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fromFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURL&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fileURLWithPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFilePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskDescription&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logFilePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;resume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delegate&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;respondsToSelector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@selector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attemptingUploadForFilePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:)])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delegate&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;attemptingUploadForFilePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logFilePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;X-BackgroundUpload-File&lt;/code&gt; contains the filename. I added &lt;code class=&quot;highlighter-rouge&quot;&gt;X-BackgroundUpload-File-UUID&lt;/code&gt; to anonymously identify each device so I could separate the log files on the server-side, and do a few security checks.&lt;/p&gt;

&lt;p&gt;I’m not going to publish the server code, as I’m pretty sure it has some vulnerabilities! Something like this, in PHP:&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hhud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rawurldecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$request_body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file_get_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'php://input'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$request_body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// do some checks and validation on input&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$fullFileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hhud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;HTTP_X_BACKGROUNDUPLOAD_FILE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// File path to save file&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filePath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'xxxxx/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$fileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$fileDir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'xxxxx/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fullFileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$fileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;basename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fullFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$fileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;preg_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/\s+/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'-'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$fileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$filePath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filePath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$fileDir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filePath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$fileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Write the request body to file&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$request_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$serverDeets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;var_export&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Failed to write to file:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_SERVER was:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$serverDeets&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;http_response_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;http_response_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To deal with old compressed files in the logs directory, I added &lt;code class=&quot;highlighter-rouge&quot;&gt;uploadOldCompressedLogFiles&lt;/code&gt; to the &lt;code class=&quot;highlighter-rouge&quot;&gt;CompressingAndUploadingLogFileManager init&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uploadOldCompressedLogFiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doUpload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NSArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unsortedLogFileInfos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;unsortedLogFileInfosGZ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DDLogFileInfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileInfo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unsortedLogFileInfos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NSLogVerbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;CompressingAndUploadingLogFileManager: fileInfo: %@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fileInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isArchived&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;NSLogVerbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;is Archived, uploading...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;uploadArchivedFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You might have spotted that there’s a property on the LogFileManager that you can set to prevent uploads (it defaults to &lt;code class=&quot;highlighter-rouge&quot;&gt;YES&lt;/code&gt;). To stop uploading, simply set to &lt;code class=&quot;highlighter-rouge&quot;&gt;NO&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;logFileManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doUpload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my &lt;a href=&quot;https://apps.apple.com/us/app/hkwarnings/id370901118#?platform=ipad&quot;&gt;HKWarnings app&lt;/a&gt;, I can set this flag from my server, enabling me to remotely switch log file uploading on and off.&lt;/p&gt;

&lt;p&gt;On the server, I end up with folders full of gzipped log files:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/compress-upload-cocoalumberjack/logs.png&quot; title=&quot;Log files&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/logs-th.png&quot; alt=&quot;Log files&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/compress-upload-cocoalumberjack/tree.png&quot; title=&quot;Log tree&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/tree-th.png&quot; alt=&quot;Log tree&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;I take a copy, unzip and &lt;code class=&quot;highlighter-rouge&quot;&gt;grep&lt;/code&gt; the logs for insights. For example, this lists debug lines and orders them by the number of times they occur:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;egrep &lt;span class=&quot;s1&quot;&gt;'\[\D\]'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Po&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' \[.*'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/^ *//g'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1182 [D] [Warning -[Warning isItNight]][Line 1619] in isItNight
1343 [D] [WarningViewController3 -[WarningViewController3 showLabel]][Line 2152] have not purchased ads
1361 [D] [NSMutableString+HKWUtilities -[NSMutableString(HKWUtilities) hkw_base64EncodedURLQueryString:]][Line 14] encQueryString is []
1377 [D] [WarningViewController3 -[WarningViewController3 showLabel]][Line 2136] In showLabel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So I can see I should make sure these are performant:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;isItNight&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;hkw_base64EncodedURLQueryString&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In fact I’ve already released a version where &lt;code class=&quot;highlighter-rouge&quot;&gt;hkw_base64EncodedURLQueryString&lt;/code&gt; is 66% faster and &lt;code class=&quot;highlighter-rouge&quot;&gt;isItNight&lt;/code&gt; is ~30% faster:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/compress-upload-cocoalumberjack/isitnight.png&quot; title=&quot;Is it night test&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/isitnight-th.png&quot; alt=&quot;Is it night test&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/compress-upload-cocoalumberjack/isitnight2.png&quot; title=&quot;Is it night 2 tests&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/isitnight2-th.png&quot; alt=&quot;Is it night 2 tests&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;Final test to check the output of the new version matches the old version:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testisItNight_isItNight2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Warning&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warning&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Warning&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isitNight2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warning&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isItNight2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isitNight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warning&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isItNight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isitNight2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isitNight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Anyway, here it is in action (click through to view the video):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cloud.stouty.xyz/s/pSmqYJQEoGbSxNH&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/uploadingLogFiles.png&quot; src=&quot;/assets/images/posts/compress-upload-cocoalumberjack/uploadingLogFiles-lq.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;Git files changes screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;</content><author><name>James Stout</name></author><category term="CocoaLumberjack" /><category term="logging" /><category term="remote logging" /><category term="compression" /><category term="CocoaPods" /><category term="pod" /><summary type="html">My first CocoaPod - a mashup of CompressingLogFileManager from CocoaLumberjack and BackgroundUpload-CocoaLumberjack.</summary></entry><entry><title type="html">Nextcloud Sync Client for Docker</title><link href="https://stouty.xyz/nextcloud/2020/05/08/nextcloud-sync/" rel="alternate" type="text/html" title="Nextcloud Sync Client for Docker" /><published>2020-05-08T22:27:27+08:00</published><updated>2020-05-08T22:27:27+08:00</updated><id>https://stouty.xyz/nextcloud/2020/05/08/nextcloud-sync</id><content type="html" xml:base="https://stouty.xyz/nextcloud/2020/05/08/nextcloud-sync/">&lt;p&gt;I’ve found the ‘native’ macOS Nextcloud client to be a bit flakey. It’s all &lt;a href=&quot;https://www.qt.io/&quot;&gt;Qt&lt;/a&gt; and &lt;a href=&quot;https://github.com/nextcloud/desktop/search?l=c%2B%2B&quot;&gt;C++&lt;/a&gt; and times out all the time.&lt;/p&gt;

&lt;p&gt;I’m trying to replace Dropbox on my Mac, as they get up to all sorts of &lt;a href=&quot;https://applehelpwriter.com/2016/07/28/revealing-dropboxs-dirty-little-security-hack/&quot;&gt;scummy&lt;/a&gt; &lt;a href=&quot;https://applehelpwriter.com/2016/08/29/discovering-how-dropbox-hacks-your-mac/&quot;&gt;behaviour&lt;/a&gt;, but it’s a little harder than expected.&lt;/p&gt;

&lt;p&gt;I mentioned in an earlier post that I &lt;a href=&quot;https://stouty.xyz/unix/2020/04/16/dupes/&quot;&gt;sync my photos to my NAS&lt;/a&gt;, then sync to Nextcloud via their &lt;a href=&quot;https://docs.nextcloud.com/desktop/2.6/advancedusage.html#nextcloud-command-line-client&quot;&gt;command line client&lt;/a&gt;, running in a &lt;a href=&quot;https://www.docker.com/&quot;&gt;Docker&lt;/a&gt; &lt;a href=&quot;https://www.docker.com/resources/what-container&quot;&gt;container&lt;/a&gt;. I run all my containers on my Synology NAS using their &lt;a href=&quot;https://www.synology.com/en-global/dsm/feature/docker&quot;&gt;Docker package&lt;/a&gt;:&lt;/p&gt;

&lt;figure class=&quot;third &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/nextcloud-sync/containers.png&quot; title=&quot;Docker containers&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/nextcloud-sync/containers-th.png&quot; alt=&quot;Docker containers&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/nextcloud-sync/containers2.png&quot; title=&quot;Docker containers&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/nextcloud-sync/containers2-th.png&quot; alt=&quot;Docker containers&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/nextcloud-sync/images.png&quot; title=&quot;Docker images&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/nextcloud-sync/images-th.png&quot; alt=&quot;Docker images&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;In the last screenshot there you can see my image: &lt;a href=&quot;https://registry.hub.docker.com/r/stoutyhk/nextcloud-client/&quot;&gt;stoutyhk/nextcloud-client&lt;/a&gt;. It’s based on the image from &lt;a href=&quot;https://github.com/juanitomint/nextcloud-client-docker&quot;&gt;juanitomint&lt;/a&gt;, with some &lt;a href=&quot;https://github.com/jamesstout/nextcloud-client-docker/commit/c6184018dcc46289cbbb59060c63870814710e59&quot;&gt;small tweaks&lt;/a&gt; to add functionality to exclude certain folders and to set folders for selective sync. I also slightly tweaked how the arguments to the client are constructed and exposed the &lt;code class=&quot;highlighter-rouge&quot;&gt;media&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;config&lt;/code&gt; folders.&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/nextcloud-sync/Dockerfile.png&quot; title=&quot;Dockerfile&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/nextcloud-sync/Dockerfile-th.png&quot; alt=&quot;Dockerfile&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/nextcloud-sync/run.png&quot; title=&quot;run.sh&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/nextcloud-sync/run-th.png&quot; alt=&quot;run.sh&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;The config folder can contain files named:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exclude&lt;/code&gt; - this contains files/folders/patterns that you don’t want to sync&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;unsyncedfolders&lt;/code&gt; - contains the list of un-synced remote folders (selective sync)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For example, I want to exclude syncing the Synology-generated metadata &lt;a href=&quot;https://www.reddit.com/r/synology/comments/an4a4l/modern_solution_to_stopping_the_generation_of/&quot;&gt;@eaDir&lt;/a&gt; directories to my server:&lt;/p&gt;

&lt;p&gt;So I have a config directory containing an &lt;code class=&quot;highlighter-rouge&quot;&gt;exclude&lt;/code&gt; file:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/config.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/config.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;config folder screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Containing:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/exclude.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/exclude.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;exclude file screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Additionally, on my server there are folders that I do not want to sync down to my NAS. So those folders go in the &lt;code class=&quot;highlighter-rouge&quot;&gt;unsyncedfolders&lt;/code&gt; file:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/unsyncedfolders.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/unsyncedfolders.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;unsyncedfolders file screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So you download the image, launch and set the &lt;a href=&quot;https://docs.docker.com/storage/volumes/&quot;&gt;volumes&lt;/a&gt; and environment variables, and start it up:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/nc-docker-settings.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/nc-docker-settings.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;nc-docker-settings screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;From the command line this would be something like:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; some_named_volume:/media/nextcloud &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; some_config_volume:/config &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NC_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NC_PASS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NC_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$server_url&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  stoutyhk/nextcloud-client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The Dockerfile CMD is run.sh, a script that parses the arguments to construct the nextcloudcmd command. For my setup it’s this:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/bin/su -s /bin/ash &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -c 'nextcloudcmd --exclude /config/exclude &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
--unsyncedfolders /config/unsyncedfolders --max-sync-retries 6 &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
--non-interactive -u &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NC_USER&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -p &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NC_PASS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /media/nextcloud &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NC_URL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;'&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This simply runs in a &lt;a href=&quot;https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_09_02.html&quot;&gt;while true loop&lt;/a&gt;, sleeping for 500s after it syncs and then checking if it needs to sync again after 500s.&lt;/p&gt;

&lt;p&gt;It’s very stable, hasn’t crashed or timed out yet. I highly recommend this method vs the native macOS client.&lt;/p&gt;

&lt;p&gt;Going full No Dropbox would mean syncing further folders and mounting them on my Mac. That’s up next.&lt;/p&gt;

&lt;p&gt;BTW, building and tweaking this is very simple. The &lt;a href=&quot;https://docs.docker.com/engine/reference/builder/&quot;&gt;Dockerfile&lt;/a&gt; describes what to do:&lt;/p&gt;

&lt;p&gt;Build image based on &lt;a href=&quot;https://www.alpinelinux.org/&quot;&gt;Alpine&lt;/a&gt; (a tiny, 2.7MB, version of Linux):&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM alpine:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Set some ARGS and ENVS:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ARG USER=ncsync
ARG GROUP=users
ARG USER_UID=1000
ARG USER_GID=100

ENV USER=$USER \
    GROUP=$GROUP \
    USER_UID=$USER_UID \
    USER_GID=$USER_GID \
    NC_USER=username \
    NC_PASS=password \
    NC_INTERVAL=500 \
    NC_URL=&quot;&quot; \
    NC_TRUST_CERT=false \
    NC_SILENT=false \
    NC_EXIT=false   \
    NC_HIDDEN=false \
    NC_MAX_SYNC_RETRIES=3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create user/group:&lt;/p&gt;
&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;RUN adduser -G $GROUP -D -u $USER_UID $USER
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Update repositories and install nextcloud-client:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;RUN apk update &amp;amp;&amp;amp; apk add nextcloud-client &amp;amp;&amp;amp; rm -rf /etc/apk/cache
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add run script and expose volumes:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ADD run.sh /usr/bin/run.sh
VOLUME [ &quot;/media/nextcloud&quot; ]
VOLUME [ &quot;/config&quot; ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, execute the command:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CMD /usr/bin/run.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The build command to build the image is:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker build &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--build-arg&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;VCS_REF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;git rev-parse &lt;span class=&quot;nt&quot;&gt;--short&lt;/span&gt; HEAD&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;--build-arg&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;BUILD_DATE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; +&lt;span class=&quot;s2&quot;&gt;&quot;%Y-%m-%dT%H:%M:%SZ&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; stoutyhk/nextcloud-client &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;build.log
docker images stoutyhk/nextcloud-client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see my current image is the one from DockerHub:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/docker-ps.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/docker-ps.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;docker-ps screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The build output:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@dusky2: /volume1/homes/james/src/nextcloud-client-docker on master[!?]
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./build.sh
Sending build context to Docker daemon  28.67kB
Step 1/19 : FROM alpine:latest
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; a187dde48cd2
Step 2/19 : LABEL &lt;span class=&quot;nv&quot;&gt;maintainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;stoutyhk&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.1&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;nextcloud sync client&quot;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;d7bcd965c0d4
Removing intermediate container d7bcd965c0d4
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b6a1c94582c9
Step 3/19 : LABEL based-on&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://github.com/juanitomint/nextcloud-client-docker&quot;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;fba05915652c
Removing intermediate container fba05915652c
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 92e4f3b6aba1
Step 4/19 : LABEL &lt;span class=&quot;nv&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://github.com/jamesstout/nextcloud-client-docker&quot;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;63258ff88545
Removing intermediate container 63258ff88545
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 07233dc234c6
Step 5/19 : ARG VCS_REF
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;f03e352100f4
Removing intermediate container f03e352100f4
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 172784412e92
Step 6/19 : ARG BUILD_DATE
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;80600d7575e4
Removing intermediate container 80600d7575e4
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 77bc2f5d481a
Step 7/19 : LABEL vcs-ref&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$VCS_REF&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;c58cdd8b58f6
Removing intermediate container c58cdd8b58f6
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 2e598c72729a
Step 8/19 : LABEL build-date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BUILD_DATE&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;d51c564b1354
Removing intermediate container d51c564b1354
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 2cf77c7ccd0f
Step 9/19 : ARG &lt;span class=&quot;nv&quot;&gt;USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ncsync
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;10c452b72d23
Removing intermediate container 10c452b72d23
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 62d6402dfe64
Step 10/19 : ARG &lt;span class=&quot;nv&quot;&gt;GROUP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2c7c84cca017
Removing intermediate container 2c7c84cca017
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 32af7f7e31a6
Step 11/19 : ARG &lt;span class=&quot;nv&quot;&gt;USER_UID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a76b14779d6e
Removing intermediate container a76b14779d6e
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; d16b1dc7fda7
Step 12/19 : ARG &lt;span class=&quot;nv&quot;&gt;USER_GID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;16a3579c0537
Removing intermediate container 16a3579c0537
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b06b174ac1cb
Step 13/19 : ENV &lt;span class=&quot;nv&quot;&gt;USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;GROUP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GROUP&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;USER_UID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER_UID&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;USER_GID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER_GID&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;NC_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;username     &lt;span class=&quot;nv&quot;&gt;NC_PASS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;password     &lt;span class=&quot;nv&quot;&gt;NC_INTERVAL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500     &lt;span class=&quot;nv&quot;&gt;NC_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;     &lt;span class=&quot;nv&quot;&gt;NC_TRUST_CERT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false     &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC_SILENT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false     &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC_EXIT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false       &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC_HIDDEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false     &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NC_MAX_SYNC_RETRIES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;85c579929ce1
Removing intermediate container 85c579929ce1
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 82c168659c42
Step 14/19 : RUN adduser &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$GROUP&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$USER_UID&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;84755af084c9
Removing intermediate container 84755af084c9
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 9888ccca2dcc
Step 15/19 : RUN apk update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk add nextcloud-client &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /etc/apk/cache
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;702eef96b765
fetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz
v3.11.6-32-g9ddc349524 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;http://dl-cdn.alpinelinux.org/alpine/v3.11/main]
v3.11.6-28-g4b76c8208f &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;http://dl-cdn.alpinelinux.org/alpine/v3.11/community]
OK: 11273 distinct packages available
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1/95&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installing dbus-libs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.12.16-r2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2/95&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installing libgcc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9.2.0-r4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3/95&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installing libffi &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3.2.1-r6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----8&lt;/span&gt;&amp;lt;&lt;span class=&quot;nt&quot;&gt;---snip---8&lt;/span&gt;&amp;lt;&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;95/95&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installing nextcloud-client &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.6.1-r0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
^@Executing busybox-1.31.1-r9.trigger
OK: 300 MiB &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;109 packages
Removing intermediate container 702eef96b765
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 3147165b6612
Step 16/19 : ADD run.sh /usr/bin/run.sh
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 11a9c630e797
Step 17/19 : VOLUME &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/media/nextcloud&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;69454b15f6b6
Removing intermediate container 69454b15f6b6
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; af98dc485510
Step 18/19 : VOLUME &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/config&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;94ac262e01a9
Removing intermediate container 94ac262e01a9
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b964f6b7c97c
Step 19/19 : CMD /usr/bin/run.sh
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Running &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;942c9ddf5ddd
Removing intermediate container 942c9ddf5ddd
 &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; aa064981bb5b
Successfully built aa064981bb5b
Successfully tagged stoutyhk/nextcloud-client:latest

real	5m50.592s
user	0m0.096s
sys	0m0.047s
REPOSITORY                  TAG                 IMAGE ID            CREATED             SIZE
stoutyhk/nextcloud-client   latest              aa064981bb5b        1 second ago        311MB
stoutyhk/nextcloud-client   &amp;lt;none&amp;gt;              6ca8291dece4        3 weeks ago         311MB
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see the &lt;code class=&quot;highlighter-rouge&quot;&gt;latest&lt;/code&gt; tag is now pointing to image &lt;code class=&quot;highlighter-rouge&quot;&gt;aa064981bb5b&lt;/code&gt;. To update, you export the settings, stop the container, &lt;code class=&quot;highlighter-rouge&quot;&gt;docker rm stoutyhk-nextcloud-client&lt;/code&gt;, then import the settings and launch the new image:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/nextcloud-sync/new-image.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/nextcloud-sync/new-image.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;new-image screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Spot of housekeeping:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@dusky2: /usr/local/bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;image &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;docker images &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;dangling=true&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;stouty | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-vE&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'IMAGE'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{ print $3 }'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;docker rmi &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$image&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done
&lt;/span&gt;Untagged: stoutyhk/nextcloud-client@sha256:024ba23cc5e182aedb3d30df1bc4e31127fe21f94b35aed55804989b8e154a98
Deleted: sha256:6ca8291dece42c3dda0cf2b6601e0ff1180cf854909b5f3474710ca84babaf04
Deleted: sha256:be8054c4d017455ca6b4afd7e00fb7da03e58beae4a3705575aabcff8af23fb9
Deleted: sha256:c9eae4086cf6c94c60590bb909fbffa90f166371d9c13a53a4a988d48747cdcc
Deleted: sha256:688a57e452c154219a34c88e18ec695ef3a15ce4a1d4f73875d56ff40a8a6de6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have a script that runs weekly to automate pulling of new images:&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/jamesstout/c19c227d1ac7dd37108ecbbf5c52eea7.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;I then need to do the export, rm, import manually as I haven’t figured out how to automate that with Synology Docker package yet.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/wagoodman/dive&quot;&gt;Dive&lt;/a&gt; is a nice tool for examining Docker &lt;a href=&quot;https://docs.docker.com/storage/storagedriver/#images-and-layers&quot;&gt;images and layers&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You can see what each command in the Dockerfile does to the image. It also gives you an image efficiency estimate:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Image Efficiency&lt;/p&gt;

  &lt;p&gt;The lower left pane shows basic layer info and an experimental metric that will guess how much wasted space your image contains. This might be from duplicating files across layers, moving files across layers, or not fully removing files. Both a percentage “score” and total wasted file space is provided.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Mine is fairly good:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Total Image size: 311MB
Potential wasted space: 179kB
Image efficiency score: 99 %
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here’s a look at &lt;code class=&quot;highlighter-rouge&quot;&gt;dive&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://asciinema.org/a/2xQFxw4LdqjYuh9cc7WEv4Xc7&quot;&gt;&lt;img src=&quot;https://asciinema.org/a/2xQFxw4LdqjYuh9cc7WEv4Xc7.svg&quot; alt=&quot;asciicast&quot; /&gt;&lt;/a&gt;&lt;/p&gt;</content><author><name>James Stout</name></author><category term="Nextcloud" /><category term="Docker" /><category term="NAS" /><category term="Synology" /><category term="docker build" /><category term="sync" /><category term="Dockerfile" /><category term="docker images" /><category term="dive" /><category term="docker layers" /><summary type="html">Syncing to Nextcloud from a Docker container, and how to build that container.</summary></entry><entry><title type="html">HKWarnings v5.0.0</title><link href="https://stouty.xyz/ios/2020/05/04/hkwarnings/" rel="alternate" type="text/html" title="HKWarnings v5.0.0" /><published>2020-05-04T23:40:49+08:00</published><updated>2020-05-04T23:40:49+08:00</updated><id>https://stouty.xyz/ios/2020/05/04/hkwarnings</id><content type="html" xml:base="https://stouty.xyz/ios/2020/05/04/hkwarnings/">&lt;p&gt;When I initially made HKWarnings &lt;a href=&quot;https://help.apple.com/xcode/mac/current/#/deve69552ee5&quot;&gt;universal&lt;/a&gt; and added an iPad interface, I based the interface on a &lt;a href=&quot;https://developer.apple.com/library/archive/samplecode/MultipleDetailViews/Introduction/Intro.html&quot;&gt;MultipleDetailViews&lt;/a&gt; demo from Apple. That version is updated, I used the older code from &lt;a href=&quot;https://developer.apple.com/library/archive/samplecode/MultipleDetailViews/History/History.html#//apple_ref/doc/uid/DTS40009775-RevisionHistory-DontLinkElementID_1&quot;&gt;2010&lt;/a&gt;, so it’s 10 years old and built for iOS 3.2.&lt;/p&gt;

&lt;p&gt;Architecturally, there’s a Master ViewController that displays multiple different Detail ViewControllers.&lt;/p&gt;

&lt;p&gt;The Master ViewController is a TableView that’s usually hidden:&lt;/p&gt;

&lt;p&gt;&lt;img data-src=&quot;/assets/images/posts/hkwarnings/master.png&quot; class=&quot;lazyload blur-up align-center&quot; alt=&quot;master vc&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It’s used to choose one of many Detail VCs:&lt;/p&gt;

&lt;figure class=&quot;third &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Four-Warning.png&quot; title=&quot;Four Warnings&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Four-Warning-th.png&quot; alt=&quot;Four Warnings&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Deets-Warning.png&quot; title=&quot;Warning Details&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Deets-Warning-th.png&quot; alt=&quot;Warning Details&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Radar.png&quot; title=&quot;Radar&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Radar-th.png&quot; alt=&quot;Radar&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Sat.png&quot; title=&quot;Sat&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Sat-th.png&quot; alt=&quot;Sat&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/TC-Warning.png&quot; title=&quot;Typhoon&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/TC-Warning-th.png&quot; alt=&quot;Typhoon&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Warnings-History.png&quot; title=&quot;Warnings-History&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Warnings-History-th.png&quot; alt=&quot;Warnings-History&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Weather-Images.png&quot; title=&quot;Weather Images&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Weather-Images-th.png&quot; alt=&quot;Weather Images&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Weather-Image.png&quot; title=&quot;Weather Image&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Weather-Image-th.png&quot; alt=&quot;Weather Image&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/Deets-Warning-Screen-CN.png&quot; title=&quot;Warning Details Chinese&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/Deets-Warning-Screen-CN-th.png&quot; alt=&quot;Warning Details Chinese&quot; /&gt;
      &lt;/a&gt;
    
  
  
    &lt;figcaption&gt;Click a row in the Master table and the selected Detail VC loads.
&lt;/figcaption&gt;
  
&lt;/figure&gt;

&lt;p&gt;Anyway, this 10 year old code has survived &lt;a href=&quot;https://en.wikipedia.org/wiki/IOS_version_history&quot;&gt;9 OS updates&lt;/a&gt;, but finally, on iOS 13, it no longer works. The code below that switches the Detail VC and hides the Master &lt;em&gt;is&lt;/em&gt; called, but the &lt;code class=&quot;highlighter-rouge&quot;&gt;UIPopoverController&lt;/code&gt; is always &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;splitViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UISplitViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;svc&lt;/span&gt;
     &lt;span class=&quot;nf&quot;&gt;willHideViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;aViewController&lt;/span&gt;
          &lt;span class=&quot;nf&quot;&gt;withBarButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIBarButtonItem&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;barButtonItem&lt;/span&gt;
       &lt;span class=&quot;nf&quot;&gt;forPopoverController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIPopoverController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pc&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Keep references to the popover controller and the popover button,&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// and tell the detail view controller to show the button.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;barButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSLocalizedString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Menu&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Menu&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popoverController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootPopoverButtonItem&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;barButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;UIViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SubstitutableDetailViewController&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detailViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewControllers&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;objectAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detailViewController&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;showRootPopoverButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootPopoverButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;splitViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UISplitViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;svc&lt;/span&gt;
     &lt;span class=&quot;nf&quot;&gt;willShowViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;aViewController&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;invalidatingBarButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIBarButtonItem&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;barButtonItem&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Nil out references to the popover controller and the popover button,&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// and tell the detail view controller to hide the button.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;UIViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SubstitutableDetailViewController&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detailViewController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewControllers&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;objectAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detailViewController&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;invalidateRootPopoverButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootPopoverButtonItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popoverController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootPopoverButtonItem&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nothing I tried could make it work. There are not too many other people searching for an answer on Stackoverflow. I started a major rewrite based on the stock Xcode Master-Detail project:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/master-detail.png&quot; title=&quot;Four Warning&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/master-detail-th.png&quot; alt=&quot;Four Warnings&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/master-detail-code.png&quot; title=&quot;Warning Details&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/master-detail-code-th.png&quot; alt=&quot;Warning Details&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;But it’s all &lt;a href=&quot;https://developer.apple.com/library/archive/documentation/ToolsLanguages/Conceptual/Xcode_Overview/DesigningwithStoryboards.html#//apple_ref/doc/uid/TP40010215-CH43-SW1&quot;&gt;Storyboards, scenes and segues&lt;/a&gt;. I’m not a fan. I soon had a huge mess of a main storyboard. I prefer to do things &lt;a href=&quot;https://www.toptal.com/ios/ios-user-interfaces-storyboards-vs-nibs-vs-custom-code&quot;&gt;programmatically&lt;/a&gt;, well, a mix of code and &lt;a href=&quot;http://www.monobjc.net/xib-file-format.html&quot;&gt;xibs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Eventually I found &lt;a href=&quot;https://github.com/mutualmobile/MMDrawerController&quot;&gt;MMDrawerController&lt;/a&gt;, it’s also fairly old code (targets iOS 7), but I quickly built a working prototype that worked on iOS 13.&lt;/p&gt;

&lt;p&gt;It took a few days, but I have just released &lt;a href=&quot;https://apps.apple.com/us/app/hkwarnings/id370901118#?platform=ipad&quot;&gt;v5.0.0 of HKWarnings&lt;/a&gt;, using the new side drawer.&lt;/p&gt;

&lt;h2 id=&quot;code-changes&quot;&gt;Code Changes&lt;/h2&gt;

&lt;p&gt;178 files were changed:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/hkwarnings/changes.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/hkwarnings/changes.png&quot; src=&quot;/assets/images/posts/hkwarnings/changes-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;Git files changes screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Lines changed:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/iPhone Apps/HKWarnings on 5.0.1[!?&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--numstat&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--pretty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%H&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--author&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;James Stout&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b318bae1 bc535bb7 | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; Pods | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; Carthage &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'NF==3 {plus+=$1; minus+=$2} END {printf(&quot;+%d, -%d\n&quot;, plus, minus)}'&lt;/span&gt;
+183978, &lt;span class=&quot;nt&quot;&gt;-119453&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;+183978, -119453&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;BTW, that command takes a &lt;em&gt;quite&lt;/em&gt; a while:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/iPhone Apps/HKWarnings on 5.0.1[!?&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--numstat&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--pretty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%H&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--author&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;James Stout&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b318bae1 bc535bb7 | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; Pods | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; Carthage &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'NF==3 {plus+=$1; minus+=$2} END {printf(&quot;+%d, -%d\n&quot;, plus, minus)}'&lt;/span&gt;
+183978, &lt;span class=&quot;nt&quot;&gt;-119453&lt;/span&gt;

real	0m40.285s
user	0m35.363s
sys	0m4.840s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;some-stats&quot;&gt;Some Stats&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/AlDanial/cloc/&quot;&gt;cloc&lt;/a&gt; output, excluding Pods:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/iPhone Apps/HKWarnings on 5.0.1[!?&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cloc &lt;span class=&quot;nt&quot;&gt;--ignored&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ignored.txt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--exclude-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Pods,HKWeatherWarningsTabs.xcodeproj,HKWeatherWarningsTabs.xcworkspace &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--exclude-ext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;entitlements,plist,strings,xcodeproj &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--report-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cloc-report3.txt &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
     394 text files.
     380 unique files.
Wrote ignored.txt
      44 files ignored.
Wrote cloc-report3.txt

github.com/AlDanial/cloc v 1.84  &lt;span class=&quot;nv&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.40 s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;873.2 files/s, 133349.8 lines/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
Language                      files          blank        comment           code
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
Objective C                      91          11963           5279          20095
XML                              41            105              5           3536
Bourne Shell                     12             83             80           3522
JSON                             99              1              0           3227
C/C++ Header                     96           1073           1060           2157
Swift                             2            108             40            448
HTML                              1             19              0            420
Bourne Again Shell                7             44             11            146
Perl                              1             21            121             30
YAML                              1              0              0              7
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
SUM:                            351          13417           6596          33588
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Including Pods:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/iPhone Apps/HKWarnings on 5.0.1[!?&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cloc &lt;span class=&quot;nt&quot;&gt;--ignored&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ignored.txt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--exclude-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;HKWeatherWarningsTabs.xcodeproj,HKWeatherWarningsTabs.xcworkspace &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--exclude-ext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;entitlements,plist,strings,xcodeproj &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--report-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cloc-inc-pods-report3.txt &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
    1645 text files.
    1101 unique files.
Wrote ignored.txt
     697 files ignored.
Wrote cloc-inc-pods-report3.txt

github.com/AlDanial/cloc v 1.84  &lt;span class=&quot;nv&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1.25 s &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;758.6 files/s, 101853.4 lines/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
Language                      files          blank        comment           code
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
Objective C                     303          18922          11355          48001
C/C++ Header                    443           5716          14128           9569
Bourne Shell                     15            124            149           3804
XML                              41            105              5           3536
Markdown                         32           1410              0           3449
JSON                            100              1              0           3255
C                                 3            379            261           1834
Swift                             2            108             40            448
HTML                              1             19              0            420
Bourne Again Shell                7             44             11            146
Perl                              1             21            121             30
YAML                              1              0              0              7
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
SUM:                            949          26849          26070          74499
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For reference, these are the &lt;a href=&quot;https://cocoapods.org/&quot;&gt;Pods&lt;/a&gt; I use:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'https://github.com/CocoaPods/Specs.git'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'https://github.com/jamesstout/Specs.git'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;platform&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:ios&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'11.0'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:HKWeatherWarningsTabs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'OneSignal'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Fabric'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Crashlytics'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt;  3.12'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'MBProgressHUD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:git&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'https://github.com/jamesstout/MBProgressHUD.git'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:branch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'pre-iOS13'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'StandardPaths'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'SDWebImage'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 4.3'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'SDWebImage/GIF'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'SAMCategories'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'TSMarkdownParser'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 2.1'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'PureLayout'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'FlatUIKit'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'KVOController'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'DTTJailbreakDetection'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'OHAttributedStringAdditions'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'JSQSystemSoundPlayer'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Google-Mobile-Ads-SDK'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'NYTPhotoViewer'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 1.2.0'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'DateTools'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'HVTableView'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'CocoaLumberjack'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 3.6.1'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'CompressingAndUploadingLogFileManager'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'GZIP'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 1.3.0'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'MMDrawerController'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:HKWarningsTests&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inherit!&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:search_paths&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;pod&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Expecta'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~&amp;gt; 1.0'&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;significant-pods&quot;&gt;Significant Pods&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.onesignal.com/&quot;&gt;OneSignal&lt;/a&gt; - for push notifications.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://fabric.io/&quot;&gt;Fabric/Crashlytics&lt;/a&gt; - for crash reporting, moving to &lt;a href=&quot;https://firebase.google.com/&quot;&gt;Firebase&lt;/a&gt; soon.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/matej/MBProgressHUD&quot;&gt;MBProgressHUD&lt;/a&gt; - an iOS activity indicator view, but pointing to a branch on my fork, so it &lt;a href=&quot;https://github.com/jamesstout/MBProgressHUD/commit/c013d38c2dee75f52245290c394c23a68c15d506&quot;&gt;compiles on iOS 12.1&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/SDWebImage/SDWebImage&quot;&gt;SDWebImage&lt;/a&gt; - an asynchronous image downloader with cache support.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/PureLayout/PureLayout&quot;&gt;PureLayout&lt;/a&gt; - API for iOS &amp;amp; OS X Auto Layout. None of that &lt;a href=&quot;https://developer.apple.com/xcode/interface-builder/&quot;&gt;IB&lt;/a&gt; rubbish.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/CocoaLumberjack/CocoaLumberjack&quot;&gt;CocoaLumberjack&lt;/a&gt; - a fast &amp;amp; simple, yet powerful &amp;amp; flexible logging framework.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/jamesstout/CompressingAndUploadingLogFileManager&quot;&gt;CompressingAndUploadingLogFileManager&lt;/a&gt; - my, as yet unpublished&lt;sup id=&quot;fnref:fn-repo&quot;&gt;&lt;a href=&quot;#fn:fn-repo&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; library, that compresses log files and then uploads them to an HTTP server for examination, stats etc.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/nicklockwood/GZIP&quot;&gt;GZIP&lt;/a&gt; - to unzip &lt;code class=&quot;highlighter-rouge&quot;&gt;.gz&lt;/code&gt; files. To &lt;a href=&quot;https://developer.apple.com/documentation/xcode/reducing_your_app_s_size/doing_basic_optimization_to_reduce_your_app_s_size?language=objc&quot;&gt;reduce package size&lt;/a&gt; I zip some text files. See below.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/laptobbe/TSMarkdownParser&quot;&gt;TSMarkdownParser&lt;/a&gt; - a markdown to NSAttributedString parser. I use it to display the &lt;a href=&quot;https://github.com/CocoaPods/CocoaPods/wiki/Acknowledgements&quot;&gt;acknowledgements&lt;/a&gt; Markdown created by the &lt;code class=&quot;highlighter-rouge&quot;&gt;pod install&lt;/code&gt; command. Again, see below.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In my Podfile, I have a &lt;code class=&quot;highlighter-rouge&quot;&gt;post_install&lt;/code&gt; hook that does various things, including, copying the acknowledgements &lt;code class=&quot;highlighter-rouge&quot;&gt;plist&lt;/code&gt; to the Settings bundle, and the Markdown to a text file that I then compress.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'fileutils'&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;FileUtils&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cp_r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Pods/Target Support Files/Pods-HKWeatherWarningsTabs/Pods-HKWeatherWarningsTabs-acknowledgements.plist'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Settings.bundle/Acknowledgements.plist'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:remove_destination&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;FileUtils&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cp_r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Pods/Target Support Files/Pods-HKWeatherWarningsTabs/Pods-HKWeatherWarningsTabs-acknowledgements.markdown'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Acknowledgements.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:remove_destination&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'zlib'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zipped&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Acknowledgements.txt.gz&quot;&lt;/span&gt;
  
&lt;span class=&quot;no&quot;&gt;Zlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;GzipWriter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zipped&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;write&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;IO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;binread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Acknowledgements.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the app code to display the Markdown, I first unzip, then parse:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;NSFileManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSFileManager&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;defaultManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathGZ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fm&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pathForResource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Acknowledgements.txt.gz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fm&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fileExistsAtPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathGZ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zippedContent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dataWithContentsOfFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathGZ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unZippedContent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zippedContent&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isGzippedData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DDLogDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Data is zipped&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;unZippedContent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zippedContent&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gunzippedData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initWithData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unZippedContent&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSUTF8StringEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;DDLogError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;Acknowledgements.txt.gz is not zipped&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;@&quot;ERROR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;DDLogDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;content is %@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TSMarkdownParser&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;standardParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NSAttributedString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;attributedStringFromMarkdown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;_textView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attributedText&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Saves about 47kB&lt;sup id=&quot;fnref:fn-gz&quot;&gt;&lt;a href=&quot;#fn:fn-gz&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/hkwarnings/gz.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/hkwarnings/gz.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;gzipped ack file&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I do this so that I can display the acknowledgements in the app, and in the OS Settings app:&lt;/p&gt;

&lt;figure class=&quot;third &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/ack-inapp.png&quot; title=&quot;acknowledgements in-app&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/ack-inapp-th.png&quot; alt=&quot;ack-inapp.png&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/ack-settings.png&quot; title=&quot;acknowledgements in setting&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/ack-settings-th.png&quot; alt=&quot;acknowledgements in settings&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/posts/hkwarnings/ack-settings-1.png&quot; title=&quot;acknowledgements in setting&quot;&gt;
          &lt;img src=&quot;/assets/images/posts/hkwarnings/ack-settings-1-th.png&quot; alt=&quot;acknowledgements in settings&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;Anyway, here’s v5.0.0 (click through to view the video):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cloud.stouty.xyz/s/ZKmpfo6pC8JTQ8r&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/hkwarnings/HKWarnings.png&quot; class=&quot;lazyload align-center blur-up&quot; alt=&quot;HKWarnings.png&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-repo&quot;&gt;
      &lt;p&gt;See that private Spec source in the &lt;a href=&quot;https://guides.cocoapods.org/using/the-podfile.html&quot;&gt;Podfile&lt;/a&gt;? &lt;code class=&quot;highlighter-rouge&quot;&gt;source 'https://github.com/jamesstout/Specs.git'&lt;/code&gt; &lt;a href=&quot;#fnref:fn-repo&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:fn-gz&quot;&gt;
      &lt;p&gt;Well, about 30kB as the GZIP library is about 17kB. &lt;a href=&quot;#fnref:fn-gz&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="iOS" /><category term="HKWarnings" /><category term="Xcode" /><category term="iPad" /><category term="UISplitViewController" /><summary type="html">Fixing 10 year old code to build HKWarnings v5.0.0.</summary></entry><entry><title type="html">Update to MobileDevice.framework on macOS Breaks Old GarageBand</title><link href="https://stouty.xyz/macos/2020/04/29/mobile-device/" rel="alternate" type="text/html" title="Update to MobileDevice.framework on macOS Breaks Old GarageBand" /><published>2020-04-29T19:31:05+08:00</published><updated>2020-04-29T19:31:05+08:00</updated><id>https://stouty.xyz/macos/2020/04/29/mobile-device</id><content type="html" xml:base="https://stouty.xyz/macos/2020/04/29/mobile-device/">&lt;p&gt;My old iMac isn’t supported by Mojave or Catalina, so I’m still on High Sierra. Whenever I update to a new iOS version, I get a &lt;a href=&quot;https://ios.gadgethacks.com/how-to/fix-software-update-is-required-connect-your-iphone-warning-your-mac-0185898/&quot;&gt;prompt from iTunes&lt;/a&gt; saying &lt;em&gt;A Software Update Is Required to Connect to Your iPhone&lt;/em&gt;, and I just blindly install.&lt;/p&gt;

&lt;p&gt;However, the latest install seems to have broken GarageBand.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/mobile-device/problem.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/mobile-device/problem.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;GarageBand Problem&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Running from the command line:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Applications/GarageBand.app/Contents/MacOS
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./GarageBand
dyld: Library not loaded: /System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A/MobileDevice
  Referenced from: /System/Library/Frameworks/CoreAudioKit.framework/Versions/A/CoreAudioKit
  Reason: no suitable image found.  Did find:
	/System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A/MobileDevice: mach-o, but wrong architecture
	/System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A/MobileDevice: &lt;span class=&quot;nb&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; failed with &lt;span class=&quot;nv&quot;&gt;errno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;45
	/System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A/MobileDevice: mach-o, but wrong architecture
Abort &lt;span class=&quot;nb&quot;&gt;trap&lt;/span&gt;: 6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hmmm, let’s check out MobileDevice:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file MobileDevice
MobileDevice: Mach-O 64-bit dynamically linked shared library x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;64-bit only. And updated recently:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/mobile-device/md.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/mobile-device/md.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;MobileDevice file listing&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For some confusion:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;arch
&lt;/span&gt;i386

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt;
x86_64

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
i386

james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;machine
i486
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Anyway, my old version of GarageBand:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/bin/file &lt;span class=&quot;s1&quot;&gt;'/Applications/GarageBand.app/Contents/MacOS/GarageBand'&lt;/span&gt;
/Applications/GarageBand.app/Contents/MacOS/GarageBand: Mach-O executable i386
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Hmmm, only 32-bit Intel code.&lt;/p&gt;

&lt;p&gt;I have a clone of my drive from before the update, let’s check out MobileDevice from back then:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Volumes/CCC/System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file MobileDevice
MobileDevice: Mach-O universal binary with 2 architectures: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;i386:Mach-O dynamically linked shared library i386] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;x86_64]
MobileDevice &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;architecture i386&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:	Mach-O dynamically linked shared library i386
MobileDevice &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;architecture x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:	Mach-O 64-bit dynamically linked shared library x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Built for both archs…&lt;/p&gt;

&lt;p&gt;Sooooo, I could fiddle with &lt;code class=&quot;highlighter-rouge&quot;&gt;csrutil&lt;/code&gt; and &lt;a href=&quot;https://forums.creativecow.net/thread/19/897177#897188&quot;&gt;replace the new framework with the one from my clone&lt;/a&gt;, or, see if there’s an update. No update has ever shown up in the App Store for GarageBand, but it turns out there is one:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/mobile-device/gb-update.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/mobile-device/gb-update.png&quot; src=&quot;/assets/images/posts/mobile-device/gb-update-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;GarageBand update&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After the update:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: /Applications/GarageBand.app/Contents/MacOS
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file GarageBand
GarageBand: Mach-O 64-bit executable x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And it works:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/mobile-device/new-gb.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/mobile-device/new-gb.png&quot; src=&quot;/assets/images/posts/mobile-device/new-gb-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;GarageBand latest version running&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Um, if you want to check out the song I recorded, here’s a preview:&lt;/p&gt;

&lt;p&gt;/assets/images/posts/mobile-device/shallow-preview.mp3&lt;/p&gt;</content><author><name>James Stout</name></author><category term="macOS" /><category term="iTunes" /><category term="GarageBand" /><category term="MobileDevice.framework" /><summary type="html">iTunes update breaks GarageBand.</summary></entry><entry><title type="html">Using Git to Deploy a Static Website</title><link href="https://stouty.xyz/webdev/2020/04/28/git-deploy/" rel="alternate" type="text/html" title="Using Git to Deploy a Static Website" /><published>2020-04-28T23:02:33+08:00</published><updated>2020-04-28T23:02:33+08:00</updated><id>https://stouty.xyz/webdev/2020/04/28/git-deploy</id><content type="html" xml:base="https://stouty.xyz/webdev/2020/04/28/git-deploy/">&lt;p&gt;This site is &lt;a href=&quot;https://en.wikipedia.org/wiki/Static_web_page#Advantages_of_a_static_website&quot;&gt;static&lt;/a&gt;, built using &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; and the &lt;a href=&quot;https://mmistakes.github.io/minimal-mistakes/docs/quick-start-guide/&quot;&gt;Minimal Mistakes&lt;/a&gt; theme.&lt;/p&gt;

&lt;p&gt;Once you have it set up, a new post is as simple as writing a new Markdown file, like this one, with the correct &lt;a href=&quot;https://jekyllrb.com/docs/front-matter/&quot;&gt;Front Matter&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/git-deploy/md.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/git-deploy/md.png&quot; src=&quot;/assets/images/posts/git-deploy/md-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;Markdown file screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Then building:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/jamesstout.github.io on master[!?&lt;span class=&quot;nv&quot;&gt;$]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ JEKYLL_ENV&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;production bundle &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;jekyll build 2&amp;gt; /dev/null
Configuration file: /Users/james/Projects/jamesstout.github.io/_config.yml
            Source: /Users/james/Projects/jamesstout.github.io
       Destination: /Users/james/Projects/jamesstout.github.io/_site
 Incremental build: disabled. Enable with &lt;span class=&quot;nt&quot;&gt;--incremental&lt;/span&gt;
      Generating...
       Jekyll Feed: Generating feed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;posts
                    &lt;span class=&quot;k&quot;&gt;done in &lt;/span&gt;1.531 seconds.
 Auto-regeneration: disabled. Use &lt;span class=&quot;nt&quot;&gt;--watch&lt;/span&gt; to enable.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Generating the new &lt;code class=&quot;highlighter-rouge&quot;&gt;_site&lt;/code&gt; folder:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/posts/git-deploy/gs.png&quot;&gt;&lt;img data-src=&quot;/assets/images/posts/git-deploy/gs.png&quot; src=&quot;/assets/images/posts/git-deploy/gs-lq.png&quot; class=&quot;lazyload blur-up&quot; alt=&quot;Git status screenshot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The Git repo for this site has the usual &lt;code class=&quot;highlighter-rouge&quot;&gt;origin&lt;/code&gt; &lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Basics-Working-with-Remotes&quot;&gt;remote&lt;/a&gt;, but also a remote named &lt;code class=&quot;highlighter-rouge&quot;&gt;deploy&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@Jamess-iMac: ~/Projects/jamesstout.github.io/.git
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;config
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;core]
	repositoryformatversion &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
	filemode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true
	&lt;/span&gt;bare &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false
	&lt;/span&gt;logallrefupdates &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true
	&lt;/span&gt;ignorecase &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;submodule]
	active &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;remote &lt;span class=&quot;s2&quot;&gt;&quot;origin&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
	url &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; https://jamesstout@github.com/jamesstout/jamesstout.github.io.git
	fetch &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; +refs/heads/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:refs/remotes/origin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
	sslVerify &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;branch &lt;span class=&quot;s2&quot;&gt;&quot;master&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
	remote &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; origin
	merge &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; refs/heads/master
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;remote &lt;span class=&quot;s2&quot;&gt;&quot;deploy&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
	url &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xxxxx@111.111.111.111:/usr/src/stouty.git
	fetch &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; +refs/heads/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:refs/remotes/deploy/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;deploy&lt;/code&gt; remote is a &lt;a href=&quot;https://mijingo.com/blog/what-is-a-bare-git-repository&quot;&gt;bare&lt;/a&gt; git repository on the Web server, that simply receives the latest git objects. There’s no working tree:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@hkwarnings: /usr/src/stouty.git
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;HEAD  branches  config  description  hooks  info  objects  packed-refs  refs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, it’s configured with a &lt;a href=&quot;https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks#_code_post_receive_code&quot;&gt;post-receive&lt;/a&gt; Git hook:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;These scripts run before and after pushes to the server.&lt;/p&gt;

  &lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;post-receive&lt;/code&gt; hook runs after the entire process is completed and can be used to update other services or notify users.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I have it configured to change directory to the Web &lt;a href=&quot;https://nginx.org/en/docs/http/ngx_http_core_module.html#root&quot;&gt;root&lt;/a&gt;, which is also a Git repo, with the same &lt;code class=&quot;highlighter-rouge&quot;&gt;origin&lt;/code&gt; as the working repo on my local machine, and simply execute &lt;code class=&quot;highlighter-rouge&quot;&gt;git pull&lt;/code&gt;&lt;sup id=&quot;fnref:fn-certbot&quot;&gt;&lt;a href=&quot;#fn:fn-certbot&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@hkwarnings: /usr/src/stouty.git/hooks
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;post-receive
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;unset &lt;/span&gt;GIT_DIR &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/html/stouty.xyz/ &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; git pull
&lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/html/stouty.xyz/_site/.well-known/acme-challenge&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-vp&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/html/stouty.xyz/_site/.well-known/acme-challenge&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; james:www-data &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/html/stouty.xyz/_site/.well-known/acme-challenge&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; james:www-data &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/html/stouty.xyz/_site/.well-known&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The deployment process is:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Commit changed files to local repo.&lt;/li&gt;
  &lt;li&gt;Push to origin.&lt;/li&gt;
  &lt;li&gt;Push to deploy.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;That’s it.&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn-certbot&quot;&gt;
      &lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;.well-known/acme-challenge&lt;/code&gt; is just to ensure the directory exists for Certbot challenges during certificate renewal. &lt;a href=&quot;#fnref:fn-certbot&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>James Stout</name></author><category term="git" /><category term="Jekyll" /><category term="git hooks" /><category term="deployment" /><summary type="html">How to use Git hooks to deploy a static site.</summary></entry><entry><title type="html">Does My Site Need HTTPS?</title><link href="https://stouty.xyz/internet/2020/04/28/ssl/" rel="alternate" type="text/html" title="Does My Site Need HTTPS?" /><published>2020-04-28T22:19:46+08:00</published><updated>2020-04-28T22:19:46+08:00</updated><id>https://stouty.xyz/internet/2020/04/28/ssl</id><content type="html" xml:base="https://stouty.xyz/internet/2020/04/28/ssl/">&lt;p&gt;&lt;a href=&quot;https://doesmysiteneedhttps.com/&quot;&gt;Does My Site Need HTTPS?&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yes, yes it does. Also see: &lt;a href=&quot;https://istlsfastyet.com/&quot;&gt;istlsfastyet.com&lt;/a&gt; and &lt;a href=&quot;https://dassur.ma/things/h2setup/&quot;&gt;h2setup&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I run a few sites, all over HTTPS, using SSL/TLS certificates from &lt;a href=&quot;https://letsencrypt.org/about/&quot;&gt;Let’s Encrypt&lt;/a&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stouty.xyz/&quot;&gt;stouty.xyz&lt;/a&gt; - this site.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://git.stouty.xyz/&quot;&gt;git.stouty.xyz&lt;/a&gt; - my painless, self-hosted &lt;a href=&quot;https://stouty.xyz/git/2020/03/11/gitea/&quot;&gt;Git service&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cloud.stouty.xyz/&quot;&gt;cloud.stouty.xyz&lt;/a&gt; - my self-hosted &lt;a href=&quot;https://nextcloud.com/athome/&quot;&gt;Nextcloud&lt;/a&gt; instance.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.hkwarnings.com/&quot;&gt;hkwarnings.com&lt;/a&gt; - blog and server for &lt;a href=&quot;https://apps.apple.com/us/app/hkwarnings/id370901118&quot;&gt;HKWarnings&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;They all get an A+ score on the &lt;a href=&quot;https://www.ssllabs.com/ssltest/&quot;&gt;Qualys SSL Lab test&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Certificates are renewed using &lt;a href=&quot;https://certbot.eff.org/&quot;&gt;Certbot&lt;/a&gt;, configured with the help of &lt;a href=&quot;https://www.digitalocean.com/community/tools/nginx&quot;&gt;nginxconfig.io&lt;/a&gt;, and protected from bad bots by &lt;a href=&quot;https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker&quot;&gt;The Ultimate Nginx Bad Bot Blocker&lt;/a&gt;.&lt;/p&gt;</content><author><name>James Stout</name></author><category term="HTTPS" /><category term="SSL" /><category term="web servers" /><summary type="html">HTTPS and SSL info.</summary></entry></feed>